diff '--color=auto' -u -r plasma-workspace-6.5.5/kcms/krdb/krdb.cpp plasma-workspace-6.5.5-new/kcms/krdb/krdb.cpp
--- plasma-workspace-6.5.5/kcms/krdb/krdb.cpp	2026-02-07 21:47:08.590091440 +0800
+++ plasma-workspace-6.5.5-new/kcms/krdb/krdb.cpp	2026-02-07 21:46:49.861962682 +0800
@@ -391,109 +391,109 @@
         KConfig kwinConfig(QStringLiteral("kwinrc"));
         KConfigGroup xwaylandGroup(&kwinConfig, u"Xwayland"_s);
         cursorSize *= xwaylandGroup.readEntry("Scale", 1.0);
-    }
-
-    QString contents;
-    contents += "Xcursor.theme: "_L1 + theme + u'\n';
-    contents += "Xcursor.size: "_L1 + QString::number(cursorSize) + u'\n';
-
-    if (exportXftSettings) {
-        contents += QLatin1String("Xft.antialias: ");
-        if (generalCfgGroup.readEntry("XftAntialias", true))
-            contents += QLatin1String("1\n");
-        else
-            contents += QLatin1String("0\n");
-
-        QString hintStyle = generalCfgGroup.readEntry("XftHintStyle", "hintslight");
-        contents += QLatin1String("Xft.hinting: ");
-        if (hintStyle.isEmpty())
-            contents += QLatin1String("-1\n");
-        else {
-            if (hintStyle != QLatin1String("hintnone"))
+    } else if (KWindowSystem::isPlatformX11()) {
+        QString contents;
+        contents += "Xcursor.theme: "_L1 + theme + u'\n';
+        contents += "Xcursor.size: "_L1 + QString::number(cursorSize) + u'\n';
+
+        if (exportXftSettings) {
+            contents += QLatin1String("Xft.antialias: ");
+            if (generalCfgGroup.readEntry("XftAntialias", true))
                 contents += QLatin1String("1\n");
             else
                 contents += QLatin1String("0\n");
-            contents += "Xft.hintstyle: "_L1 + hintStyle + u'\n';
-        }
 
-        QString subPixel = generalCfgGroup.readEntry("XftSubPixel", "rgb");
-        if (!subPixel.isEmpty())
-            contents += "Xft.rgba: "_L1 + subPixel + u'\n';
-
-        int dpi = xftDpi();
-        if (dpi > 0)
-            contents += "Xft.dpi: "_L1 + QString::number(dpi) + u'\n';
-        else {
-            KProcess queryProc;
-            queryProc << QStringLiteral("@xrdb@") << QStringLiteral("-query");
-            queryProc.setOutputChannelMode(KProcess::OnlyStdoutChannel);
-            queryProc.start();
-            if (queryProc.waitForFinished()) {
-                QByteArray db = queryProc.readAllStandardOutput();
-                int idx1 = 0;
-                while (idx1 < db.size()) {
-                    int idx2 = db.indexOf('\n', idx1);
-                    if (idx2 == -1) {
-                        idx2 = db.size() - 1;
-                    }
-                    const auto entry = QByteArray::fromRawData(db.constData() + idx1, idx2 - idx1 + 1);
-                    if (entry.startsWith("Xft.dpi:")) {
-                        db.remove(idx1, entry.size());
-                    } else {
-                        idx1 = idx2 + 1;
+            QString hintStyle = generalCfgGroup.readEntry("XftHintStyle", "hintslight");
+            contents += QLatin1String("Xft.hinting: ");
+            if (hintStyle.isEmpty())
+                contents += QLatin1String("-1\n");
+            else {
+                if (hintStyle != QLatin1String("hintnone"))
+                    contents += QLatin1String("1\n");
+                else
+                    contents += QLatin1String("0\n");
+                contents += "Xft.hintstyle: "_L1 + hintStyle + u'\n';
+            }
+
+            QString subPixel = generalCfgGroup.readEntry("XftSubPixel", "rgb");
+            if (!subPixel.isEmpty())
+                contents += "Xft.rgba: "_L1 + subPixel + u'\n';
+
+            int dpi = xftDpi();
+            if (dpi > 0)
+                contents += "Xft.dpi: "_L1 + QString::number(dpi) + u'\n';
+            else {
+                KProcess queryProc;
+                queryProc << QStringLiteral("@xrdb@") << QStringLiteral("-query");
+                queryProc.setOutputChannelMode(KProcess::OnlyStdoutChannel);
+                queryProc.start();
+                if (queryProc.waitForFinished()) {
+                    QByteArray db = queryProc.readAllStandardOutput();
+                    int idx1 = 0;
+                    while (idx1 < db.size()) {
+                        int idx2 = db.indexOf('\n', idx1);
+                        if (idx2 == -1) {
+                            idx2 = db.size() - 1;
+                        }
+                        const auto entry = QByteArray::fromRawData(db.constData() + idx1, idx2 - idx1 + 1);
+                        if (entry.startsWith("Xft.dpi:")) {
+                            db.remove(idx1, entry.size());
+                        } else {
+                            idx1 = idx2 + 1;
+                        }
                     }
-                }
 
-                KProcess loadProc;
-                loadProc << QStringLiteral("@xrdb@") << QStringLiteral("-quiet") << QStringLiteral("-load") << QStringLiteral("-nocpp");
-                loadProc.start();
-                if (loadProc.waitForStarted()) {
-                    loadProc.write(db);
-                    loadProc.closeWriteChannel();
-                    loadProc.waitForFinished();
+                    KProcess loadProc;
+                    loadProc << QStringLiteral("@xrdb@") << QStringLiteral("-quiet") << QStringLiteral("-load") << QStringLiteral("-nocpp");
+                    loadProc.start();
+                    if (loadProc.waitForStarted()) {
+                        loadProc.write(db);
+                        loadProc.closeWriteChannel();
+                        loadProc.waitForFinished();
+                    }
                 }
             }
         }
-    }
 
-    if (contents.length() > 0)
-        tmpFile.write(contents.toLatin1());
+        if (contents.length() > 0)
+            tmpFile.write(contents.toLatin1());
 
-    tmpFile.flush();
+        tmpFile.flush();
 
-    KProcess proc;
+        KProcess proc;
 #ifndef NDEBUG
-    proc << QStringLiteral("@xrdb@") << QStringLiteral("-merge") << tmpFile.fileName();
+        proc << QStringLiteral("@xrdb@") << QStringLiteral("-merge") << tmpFile.fileName();
 #else
-    proc << u"@xrdb@"_s << u"-quiet"_s << u"-merge"_s << tmpFile.fileName();
+        proc << u"@xrdb@"_s << u"-quiet"_s << u"-merge"_s << tmpFile.fileName();
 #endif
-    proc.execute();
+        proc.execute();
 
 #if HAVE_X11
-    xcb_connection_t *connection = xcb_connect(nullptr, nullptr);
-    if (!xcb_connection_has_error(connection)) {
-        xcb_screen_t *screen = xcb_setup_roots_iterator(xcb_get_setup(connection)).data;
-
-        // Needed for applications that don't set their own cursor.
-        xcb_cursor_context_t *context = nullptr;
-        if (xcb_cursor_context_new(connection, screen, &context) < 0) {
-            qWarning() << "xcb_cursor_context_new() failed";
-        } else {
-            xcb_cursor_t cursor = xcb_cursor_load_cursor(context, "left_ptr");
-            auto cookie = xcb_change_window_attributes_checked(connection, screen->root, XCB_CW_CURSOR, &cursor);
-            if (auto error = xcb_request_check(connection, cookie)) {
-                qWarning() << "Failed to set root window cursor, error code:" << error->error_code;
-                free(error);
+        xcb_connection_t *connection = xcb_connect(nullptr, nullptr);
+        if (!xcb_connection_has_error(connection)) {
+            xcb_screen_t *screen = xcb_setup_roots_iterator(xcb_get_setup(connection)).data;
+
+            // Needed for applications that don't set their own cursor.
+            xcb_cursor_context_t *context = nullptr;
+            if (xcb_cursor_context_new(connection, screen, &context) < 0) {
+                qWarning() << "xcb_cursor_context_new() failed";
+            } else {
+                xcb_cursor_t cursor = xcb_cursor_load_cursor(context, "left_ptr");
+                auto cookie = xcb_change_window_attributes_checked(connection, screen->root, XCB_CW_CURSOR, &cursor);
+                if (auto error = xcb_request_check(connection, cookie)) {
+                    qWarning() << "Failed to set root window cursor, error code:" << error->error_code;
+                    free(error);
+                }
+                xcb_free_cursor(connection, cursor);
+                xcb_cursor_context_free(context);
             }
-            xcb_free_cursor(connection, cursor);
-            xcb_cursor_context_free(context);
+        } else {
+            qWarning() << "xcb_connect() failed";
         }
-    } else {
-        qWarning() << "xcb_connect() failed";
-    }
 
-    xcb_disconnect(connection);
+        xcb_disconnect(connection);
 #endif
+    }
 
     applyGtkStyles(1);
     applyGtkStyles(2);
