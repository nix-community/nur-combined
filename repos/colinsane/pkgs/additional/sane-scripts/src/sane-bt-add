#!/usr/bin/env nix-shell
#!nix-shell -i python3 -p "python3.withPackages (ps: [ ps.sane-lib.bt ])" -p sane-scripts.lib.bt.propagatedBuildInputs
# vim: set filetype=python :

import argparse
import logging

from sane_bt import MediaMeta, TransmissionApi


def main():
    logging.basicConfig()
    logging.getLogger().setLevel(logging.INFO)

    parser = argparse.ArgumentParser(description="instruct servo to download some torrent")
    TransmissionApi.add_arguments(parser)
    MediaMeta.add_arguments(parser)
    parser.add_argument("torrent", help="magnet: URI or file path to torrent")

    args = parser.parse_args()
    meta = MediaMeta.from_arguments(args)
    bt_api = TransmissionApi.from_arguments(args)
    torrent = args.torrent

    bt_api.add_or_move_torrent(meta, torrent)

if __name__ == "__main__":
    main()
