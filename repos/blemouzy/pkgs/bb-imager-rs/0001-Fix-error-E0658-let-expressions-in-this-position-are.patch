From 9abfc4d52a8b9276b465fd4de702830b53e437e2 Mon Sep 17 00:00:00 2001
From: Benjamin Lemouzy <blemouzy.ml@gmail.com>
Date: Sat, 31 Jan 2026 20:39:57 +0100
Subject: [PATCH] Fix error[E0658]: `let` expressions in this position are
 unstable

---
 bb-downloader/src/lib.rs      | 9 ++++-----
 bb-flasher-sd/src/flashing.rs | 8 ++++----
 bb-imager-gui/src/helpers.rs  | 9 +++++----
 3 files changed, 13 insertions(+), 13 deletions(-)

diff --git a/bb-downloader/src/lib.rs b/bb-downloader/src/lib.rs
index 0463adb..f8b263a 100644
--- a/bb-downloader/src/lib.rs
+++ b/bb-downloader/src/lib.rs
@@ -107,12 +107,11 @@ impl Downloader {
         let file_path = self.path_from_sha(sha256);
 
         if file_path.exists() {
-            if let Ok(hash) = sha256_from_path(&file_path).await
-                && hash == sha256
-            {
-                return Some(file_path);
+            if let Ok(hash) = sha256_from_path(&file_path).await {
+                if hash == sha256 {
+                    return Some(file_path);
+                }
             }
-
             // Delete old file
             let _ = tokio::fs::remove_file(&file_path).await;
         }
diff --git a/bb-flasher-sd/src/flashing.rs b/bb-flasher-sd/src/flashing.rs
index fe1e799..02fbcef 100644
--- a/bb-flasher-sd/src/flashing.rs
+++ b/bb-flasher-sd/src/flashing.rs
@@ -209,10 +209,10 @@ pub async fn flash<R: Read + Send + 'static>(
     customization: Option<Customization>,
     cancel: Option<tokio_util::sync::CancellationToken>,
 ) -> Result<()> {
-    if let Some(x) = &customization
-        && !x.validate()
-    {
-        return Err(crate::Error::InvalidCustomizaton);
+    if let Some(x) = &customization {
+        if !x.validate() {
+            return Err(crate::Error::InvalidCustomizaton);
+        }
     }
 
     tracing::info!("Opening Destination");
diff --git a/bb-imager-gui/src/helpers.rs b/bb-imager-gui/src/helpers.rs
index 6a4848f..b6bdcd4 100644
--- a/bb-imager-gui/src/helpers.rs
+++ b/bb-imager-gui/src/helpers.rs
@@ -387,12 +387,13 @@ pub(crate) fn system_keymap() -> String {
         parts.next();
         if let Some(region) = parts.next() {
             let region = region.split('@').next().unwrap_or(region).trim();
-            if !region.is_empty()
-                && let Some(&canon) = crate::constants::KEYMAP_LAYOUTS
+            if !region.is_empty() {
+                if let Some(&canon) = crate::constants::KEYMAP_LAYOUTS
                     .iter()
                     .find(|k| k.eq_ignore_ascii_case(region))
-            {
-                return Some(canon.to_string());
+                {
+                    return Some(canon.to_string());
+                }
             }
         }
 
-- 
2.51.2

