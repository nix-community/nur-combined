var js=Object.defineProperty;var Ts=(s,a,n)=>a in s?js(s,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[a]=n;var Pe=(s,a,n)=>Ts(s,typeof a!="symbol"?a+"":a,n);import{A as cr,C as ur,a as mr}from"./CitrixRDPConfiguration-TL4axaE-.js";import{c1 as Cs,c2 as Os,r as v,c3 as Es,c4 as As,c5 as be,aa as e,c7 as we,c6 as Ps,c8 as ve,c9 as Ds,dj as ws,dk as Is,dl as Ns,dm as Ye,bw as F,dn as Rs,dp as Ve,dq as Ms,cI as ge,cK as fe,aj as de,dr as is,ai as Y,ds as Us,aJ as P,bZ as Ls,cG as os,a$ as ks,dt as Fs,b2 as Gs,ab as w,R as Fe,bL as U,du as M,ac as Ie,dv as Hs,cJ as Zs,cy as V,aX as Oe,cB as J,dw as b,dx as I,dy as De,dz as G,dA as K,dB as z,dC as ue,dD as me,dE as he,dF as Ge,dG as Bs,dH as He,bQ as xe,cC as q,cz as re,cA as ne,dI as Qs,dJ as ls,dK as ds,dL as le,dM as Q,dN as cs,dO as us,dP as pe,aS as qs,ao as Ws,dQ as $s,dR as ms,bx as ae,dS as Je,c0 as _e,dT as Ks,dU as Ne,dV as Ze,ce as je,cE as hs,dW as zs,dX as Ys,dY as Vs,dZ as Js,d_ as Xs,d$ as et,cR as st,cM as tt,cN as at,cO as rt,cP as nt,e0 as it,e1 as ot,e2 as lt,e3 as se,aA as Le,Z as dt,e4 as Xe,av as es,e5 as ct,e6 as ke,e7 as ut,e8 as mt,cx as oe,e9 as ps,ea as ht,bM as pt,bR as gt,cX as ft,eb as xt,ec as St,ed as yt,d9 as ie}from"./index-DV5vAjQm.js";import{g$ as pr,h3 as gr,h4 as fr,e$ as xr,f0 as Sr,eX as yr,f1 as br,hO as vr,eY as _r,eZ as jr,eW as Tr,hy as Cr,bs as Or,bf as Er,eu as Ar,ee as Pr,f6 as Dr,f7 as wr,f2 as Ir,f3 as Nr,f8 as Rr,hR as Mr,f4 as Ur,f5 as Lr,hB as kr,ef as Fr,fb as Gr,fc as Hr,f9 as Zr,fa as Br,eg as Qr,ha as qr,ev as Wr,es as $r,d6 as Kr,er as zr,d2 as Yr,ex as Vr,ey as Jr,hN as Xr,hM as en,hg as sn,hi as tn,fO as an,e_ as rn,gH as nn,eh as on,fL as ln,dd as dn,g0 as cn,eo as un,ci as mn,gc as hn,gd as pn,ep as gn,cn as fn,d5 as xn,ei as Sn,cp as yn,hr as bn,co as vn,ej as _n,da as jn,eM as Tn,fM as Cn,fN as On,cU as En,ek as An,ew as Pn,gZ as Dn,gV as wn,hL as In,et as Nn,eq as Rn,el as Mn,gQ as Un,eG as Ln,d3 as kn,hf as Fn,d1 as Gn,h1 as Hn,h0 as Zn,aP as Bn,go as Qn,eH as qn,hG as Wn,hH as $n,hp as Kn,em as zn,hz as Yn,b4 as Vn,cj as Jn,hh as Xn,hj as ei,gp as si,gD as ti,gt as ai,gx as ri,gv as ni,gz as ii,gr as oi,gF as li,gB as di,gA as ci,gC as ui,gs as mi,gw as hi,gu as pi,gy as gi,gq as fi,gE as xi,eN as Si,eO as yi,hJ as bi,hE as _i,en as ji,hF as Ti,eK as Ci,eJ as Oi,eL as Ei,eI as Ai,hQ as Pi,hP as Di,d4 as wi,gP as Ii,fW as Ni,fY as Ri,fB as Mi,gO as Ui,gS as Li,hw as ki,eV as Fi,dc as Gi,gn as Hi,gN as Zi,eE as Bi,eU as Qi,fC as qi,fm as Wi,eB as $i,hl as Ki,ff as zi,hk as Yi,fQ as Vi,hm as Ji,fj as Xi,hv as eo,fD as so,fE as to,eR as ao,fV as ro,eC as no,db as io,eT as oo,hA as lo,fo as co,fl as uo,am as mo,gJ as ho,gM as po,gG as go,bF as fo,gR as xo,gT as So,hD as yo,fR as bo,fS as vo,fF as _o,g1 as jo,hd as To,h5 as Co,h6 as Oo,h8 as Eo,h9 as Ao,hc as Po,h7 as Do,gX as wo,gW as Io,hb as No,fh as Ro,fi as Mo,fg as Uo,fs as Lo,hq as ko,ez as Fo,g2 as Go,cq as Ho,fU as Zo,d0 as Bo,h2 as Qo,df as qo,bE as Wo,gI as $o,c$ as Ko,hs as zo,ct as Yo,cL as Vo,eD as Jo,eF as Xo,bA as el,eQ as sl,gY as tl,dh as al,fT as rl,bu as nl,fG as il,fH as ol,gU as ll,he as dl,f_ as cl,fX as ul,fZ as ml,hn as hl,fn as pl,fk as gl,fI as fl,fJ as xl,hu as Sl,fe as yl,al as bl,fK as vl,b0 as _l,b1 as jl,gK as Tl,hx as Cl,gL as Ol,ht as El,fP as Al,eA as Pl,bn as Dl,gi as wl,gk as Il,gj as Nl,ho as Rl,gm as Ml,gl as Ul,g3 as Ll,cu as kl,eS as Fl,ft as Gl,fu as Hl,fx as Zl,fy as Bl,af as Ql,b3 as ql,fv as Wl,fw as $l,fz as Kl,fA as zl,hC as Yl,b5 as Vl,aZ as Jl,d7 as Xl,b7 as ed,ak as sd,g8 as td,f$ as ad,cs as rd,bz as nd,cv as id,g4 as od,g9 as ld,ga as dd,fq as cd,gf as ud,fr as md,gb as hd,hI as pd,fd as gd,fp as fd,aR as xd,ag as Sd,b6 as yd,aY as bd,hK as vd,aW as _d,bC as jd,bB as Td,ge as Cd,g6 as Od,eP as Ed,d8 as Ad,bD as Pd,bm as Dd,g5 as wd,g7 as Id,g_ as Nd,gh as Rd,gg as Md,bg as Ud}from"./index-DV5vAjQm.js";import{T as bt}from"./GroupManagementContent-BVFcCtUd.js";import{b as kd,c as Fd,A as Gd,a as Hd,d as Zd,C as Bd,D as Qd,G as qd}from"./GroupManagementContent-BVFcCtUd.js";import{C as $d,a as Kd}from"./CollectorCardList-B374I8cg.js";import{B as Yd,I as Vd,S as Jd,Z as Xd,g as ec,i as sc,u as tc,a as ac}from"./utils-BJWXTltN.js";import{C as Ce}from"./DeleteConfirmationDialog-D1N1r2Jm.js";import{D as nc}from"./DeleteConfirmationDialog-D1N1r2Jm.js";import{F as gs}from"./FeatureFlag-CkWkBsnO.js";import{R as oc,T as lc,C as dc,U as cc,j as uc,W as mc,E as hc,h as pc,k as gc,G as fc,V as xc,m as Sc,N as yc,l as bc,P as vc,X as _c,Y as jc,Z as Tc,a1 as Cc,_ as Oc,S as Ec,$ as Ac,a0 as Pc,g as Dc,M as wc,q as Ic,A as Nc,v as Rc,O as Mc,Q as Uc,p as Lc,n as kc,w as Fc,o as Gc,t as Hc,i as Zc,s as Bc,y as Qc,r as qc,u as Wc,F as $c,c as Kc,B as zc,I as Yc,f as Vc,L as Jc,e as Xc,J as eu,a as su,d as tu,b as au,K as ru,x as nu,D as iu,z as ou,H as lu}from"./PathfindingSearch-BrYhzNgH.js";import{a as cu,W as uu,F as mu,O as hu,u as pu,b as gu}from"./EntityInfoDataTable-A7rM9L2l.js";import{E as xu,H as Su,S as yu,g as bu,q as vu}from"./ExploreSearchCombobox-BJbkwezM.js";import{u as Be}from"./useMountEffect-CPPlFtO6.js";import{L as vt}from"./LoadingOverlay-B6fAvbKP.js";import{L as ju,a as Tu,O as Cu}from"./OneTimePasscodeForm-BgKAMJSx.js";import{P as Eu}from"./PasswordResetForm-CELK58LM.js";import{S as Pu}from"./SourceKindsCheckboxes-q4l60W6G.js";import{S as wu,u as Iu}from"./SimpleEnvironmentSelector-B_K17Cs3.js";import{A as Ru,a as Mu}from"./types-CA_l8UP3.js";import{S as Lu,g as ku}from"./utils-DkcJaQK6.js";import{u as Gu}from"./useDebouncedValue-DdsEUO8g.js";import{a as Zu,e as Bu,p as Qu,u as qu,c as Wu,b as $u}from"./useAvailableEnvironments-Dp1ClacZ.js";import{a as zu,u as Yu,b as Vu}from"./useConfiguration-CjBq8UAR.js";import{a as Xu,g as em,s as sm,u as tm,v as am}from"./useSearch-BB_-T_X7.js";import{a as nm,c as im}from"./numberFormatting-CcJZFsr8.js";import{f as _t}from"./find-oSSL8qyc.js";import"./KeyboardArrowRight-_w151gzY.js";import"./capitalize-CoGxfxlT.js";import"./CypherEditor-B5mKnHUQ.js";function jt(s){return Os("MuiSwitch",s)}const Z=Cs("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Tt=["className","color","edge","size","sx"],Ct=s=>{const{classes:a,edge:n,size:t,color:r,checked:i,disabled:l}=s,o={root:["root",n&&`edge${ve(n)}`,`size${ve(t)}`],switchBase:["switchBase",`color${ve(r)}`,i&&"checked",l&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},d=Ds(o,jt,a);return be({},a,d)},Ot=we("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:n}=s;return[a.root,n.edge&&a[`edge${ve(n.edge)}`],a[`size${ve(n.size)}`]]}})(({ownerState:s})=>be({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},s.edge==="start"&&{marginLeft:-8},s.edge==="end"&&{marginRight:-8},s.size==="small"&&{width:40,height:24,padding:7,[`& .${Z.thumb}`]:{width:16,height:16},[`& .${Z.switchBase}`]:{padding:4,[`&.${Z.checked}`]:{transform:"translateX(16px)"}}})),Et=we(ws,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(s,a)=>{const{ownerState:n}=s;return[a.switchBase,{[`& .${Z.input}`]:a.input},n.color!=="default"&&a[`color${ve(n.color)}`]]}})(({theme:s})=>({position:"absolute",top:0,left:0,zIndex:1,color:s.vars?s.vars.palette.Switch.defaultColor:`${s.palette.mode==="light"?s.palette.common.white:s.palette.grey[300]}`,transition:s.transitions.create(["left","transform"],{duration:s.transitions.duration.shortest}),[`&.${Z.checked}`]:{transform:"translateX(20px)"},[`&.${Z.disabled}`]:{color:s.vars?s.vars.palette.Switch.defaultDisabledColor:`${s.palette.mode==="light"?s.palette.grey[100]:s.palette.grey[600]}`},[`&.${Z.checked} + .${Z.track}`]:{opacity:.5},[`&.${Z.disabled} + .${Z.track}`]:{opacity:s.vars?s.vars.opacity.switchTrackDisabled:`${s.palette.mode==="light"?.12:.2}`},[`& .${Z.input}`]:{left:"-100%",width:"300%"}}),({theme:s,ownerState:a})=>be({"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.action.activeChannel} / ${s.vars.palette.action.hoverOpacity})`:Ye(s.palette.action.active,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},a.color!=="default"&&{[`&.${Z.checked}`]:{color:(s.vars||s).palette[a.color].main,"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette[a.color].mainChannel} / ${s.vars.palette.action.hoverOpacity})`:Ye(s.palette[a.color].main,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Z.disabled}`]:{color:s.vars?s.vars.palette.Switch[`${a.color}DisabledColor`]:`${s.palette.mode==="light"?Is(s.palette[a.color].main,.62):Ns(s.palette[a.color].main,.55)}`}},[`&.${Z.checked} + .${Z.track}`]:{backgroundColor:(s.vars||s).palette[a.color].main}})),At=we("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(s,a)=>a.track})(({theme:s})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:s.transitions.create(["opacity","background-color"],{duration:s.transitions.duration.shortest}),backgroundColor:s.vars?s.vars.palette.common.onBackground:`${s.palette.mode==="light"?s.palette.common.black:s.palette.common.white}`,opacity:s.vars?s.vars.opacity.switchTrack:`${s.palette.mode==="light"?.38:.3}`})),Pt=we("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(s,a)=>a.thumb})(({theme:s})=>({boxShadow:(s.vars||s).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),Dt=v.forwardRef(function(a,n){const t=Es({props:a,name:"MuiSwitch"}),{className:r,color:i="primary",edge:l=!1,size:o="medium",sx:d}=t,g=As(t,Tt),y=be({},t,{color:i,edge:l,size:o}),u=Ct(y),h=e.jsx(Pt,{className:u.thumb,ownerState:y});return e.jsxs(Ot,{className:Ps(u.root,r),sx:d,ownerState:y,children:[e.jsx(Et,be({type:"checkbox",icon:h,checkedIcon:h,ref:n,ownerState:y},g,{classes:be({},u,{root:u.switchBase})})),e.jsx(At,{className:u.track,ownerState:y})]})});var wt=(s=>(s.INVALID_DATE="Must be a valid date in yyyy-mm-dd format.",s.INVALID_RANGE_START="Start date must be before end date.",s.INVALID_RANGE_END="End date must be after start date.",s))(wt||{});const Ma="start-date",Ua="end-date",Qe=["session_collection","local_group_collection","ad_structure_collection","cert_services_collection","ca_registry_collection","dc_registry_collection"],It={[-1]:"Invalid",0:"Ready",1:"Running",2:"Complete",3:"Canceled",4:"Timed Out",5:"Failed",6:"Ingesting",7:"Analyzing",8:"Partially Completed"},Nt={[-1]:{status:"bad"},0:{status:"good"},1:{status:"pending",pulse:!0},2:{status:"good"},3:{status:"bad"},4:{status:"bad"},5:{status:"bad"},6:{status:"pending",pulse:!0},7:{status:"pending"},8:{status:"pending"}},Rt={session_collection:"Sessions",local_group_collection:"Local Groups",ad_structure_collection:"AD Structure",cert_services_collection:"Certificate Services",ca_registry_collection:"CA Registry",dc_registry_collection:"DC Registry"},La=s=>Qe.reduce((a,n)=>(s[n]===!0&&(a[n]=!0),a),{}),ka=s=>Qe.includes(s),Mt="Your role does not permit viewing finished job details. Please contact your administrator for assistance.",ss="finished-jobs-permission",Ut="Unable to fetch finished jobs. Please try again.",Lt="finished-jobs-error",Fa=s=>Qe.filter(a=>s[a]===!0).map(a=>Rt[a]).join(", "),kt={dayOfMonth:"d",fullDate:"DD",fullDateWithWeekday:"DDDD",fullDateTime:"ff",fullDateTime12h:"DD, hh:mm a",fullDateTime24h:"DD, T",fullTime:"t",fullTime12h:"hh:mm a",fullTime24h:"HH:mm",hours12h:"hh",hours24h:"HH",keyboardDate:"D",keyboardDateTime:"D t",keyboardDateTime12h:"D hh:mm a",keyboardDateTime24h:"D T",minutes:"mm",seconds:"ss",month:"LLLL",monthAndDate:"MMMM d",monthAndYear:"LLLL yyyy",monthShort:"MMM",weekday:"cccc",weekdayShort:"ccc",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",shortDate:"MMM d",year:"yyyy"};class Ft{constructor({locale:a,formats:n}={}){this.lib="luxon",this.toJsDate=t=>t.toJSDate(),this.parseISO=t=>F.fromISO(t),this.toISO=t=>t.toISO({format:"extended"}),this.parse=(t,r)=>t===""?null:F.fromFormat(t,r,{locale:this.locale}),this.is12HourCycleInCurrentLocale=()=>{var t,r;return typeof Intl>"u"||typeof Intl.DateTimeFormat>"u"?!0:!!(!((r=(t=new Intl.DateTimeFormat(this.locale,{hour:"numeric"}))===null||t===void 0?void 0:t.resolvedOptions())===null||r===void 0)&&r.hour12)},this.getFormatHelperText=t=>"",this.getCurrentLocaleCode=()=>this.locale||Rs.defaultLocale,this.addSeconds=(t,r)=>t.plus({seconds:r}),this.addMinutes=(t,r)=>t.plus({minutes:r}),this.addHours=(t,r)=>t.plus({hours:r}),this.addDays=(t,r)=>t.plus({days:r}),this.addWeeks=(t,r)=>t.plus({weeks:r}),this.addMonths=(t,r)=>t.plus({months:r}),this.addYears=(t,r)=>t.plus({years:r}),this.isValid=t=>{var r,i;return F.isDateTime(t)?t.isValid:t===null?!1:(i=(r=this.date(t))===null||r===void 0?void 0:r.isValid)!==null&&i!==void 0?i:!1},this.isEqual=(t,r)=>{var i,l;return t===null&&r===null?!0:t===null||r===null||!this.date(r)?!1:(l=(i=this.date(t))===null||i===void 0?void 0:i.equals(this.date(r)))!==null&&l!==void 0?l:!1},this.isSameDay=(t,r)=>t.hasSame(r,"day"),this.isSameMonth=(t,r)=>t.hasSame(r,"month"),this.isSameYear=(t,r)=>t.hasSame(r,"year"),this.isSameHour=(t,r)=>t.hasSame(r,"hour"),this.isAfter=(t,r)=>t>r,this.isBefore=(t,r)=>t<r,this.isBeforeDay=(t,r)=>t.diff(r.startOf("day"),"days").toObject().days<0,this.isAfterDay=(t,r)=>t.diff(r.endOf("day"),"days").toObject().days>0,this.isBeforeMonth=(t,r)=>t.diff(r.startOf("month"),"months").toObject().months<0,this.isAfterMonth=(t,r)=>t.diff(r.startOf("month"),"months").toObject().months>0,this.isBeforeYear=(t,r)=>t.diff(r.startOf("year"),"years").toObject().years<0,this.isAfterYear=(t,r)=>t.diff(r.endOf("year"),"years").toObject().years>0,this.getDiff=(t,r,i)=>(typeof r=="string"&&(r=F.fromJSDate(new Date(r))),r.isValid?i?Math.floor(t.diff(r).as(i)):t.diff(r).as("millisecond"):0),this.startOfDay=t=>t.startOf("day"),this.endOfDay=t=>t.endOf("day"),this.format=(t,r)=>this.formatByString(t,this.formats[r]),this.formatByString=(t,r)=>t.setLocale(this.locale).toFormat(r),this.formatNumber=t=>t,this.getHours=t=>t.get("hour"),this.setHours=(t,r)=>t.set({hour:r}),this.getMinutes=t=>t.get("minute"),this.setMinutes=(t,r)=>t.set({minute:r}),this.getSeconds=t=>t.get("second"),this.setSeconds=(t,r)=>t.set({second:r}),this.getWeek=t=>t.get("weekNumber"),this.getMonth=t=>t.get("month")-1,this.getDaysInMonth=t=>t.daysInMonth,this.setMonth=(t,r)=>t.set({month:r+1}),this.getYear=t=>t.get("year"),this.setYear=(t,r)=>t.set({year:r}),this.getDate=t=>t.get("day"),this.setDate=(t,r)=>t.set({day:r}),this.mergeDateAndTime=(t,r)=>t.set({second:r.second,hour:r.hour,minute:r.minute}),this.startOfYear=t=>t.startOf("year"),this.endOfYear=t=>t.endOf("year"),this.startOfMonth=t=>t.startOf("month"),this.endOfMonth=t=>t.endOf("month"),this.startOfWeek=t=>t.startOf("week"),this.endOfWeek=t=>t.endOf("week"),this.getNextMonth=t=>t.plus({months:1}),this.getPreviousMonth=t=>t.minus({months:1}),this.getMonthArray=t=>{const i=[t.startOf("year")];for(;i.length<12;){const l=i[i.length-1];i.push(this.getNextMonth(l))}return i},this.getWeekdays=()=>Ve.weekdaysFormat("short",{locale:this.locale}),this.getWeekArray=t=>{const{days:r}=t.endOf("month").endOf("week").diff(t.startOf("month").startOf("week"),"days").toObject(),i=[];return new Array(Math.round(r)).fill(0).map((l,o)=>o).map(l=>t.startOf("month").startOf("week").plus({days:l})).forEach((l,o)=>{if(o===0||o%7===0&&o>6){i.push([l]);return}i[i.length-1].push(l)}),i},this.getYearRange=(t,r)=>{const i=t.startOf("year"),l=r.endOf("year");let o=i;const d=[];for(;o<l;)d.push(o),o=o.plus({year:1});return d},this.getMeridiemText=t=>Ve.meridiems({locale:this.locale}).find(r=>r.toLowerCase()===t.toLowerCase()),this.isNull=t=>t===null,this.isWithinRange=(t,[r,i])=>t.equals(r)||t.equals(i)||this.isAfter(t,r)&&this.isBefore(t,i),this.locale=a||"en-US",this.formats=Object.assign({},kt,n)}date(a){return typeof a>"u"?F.local():a===null?null:typeof a=="string"?F.fromJSDate(new Date(a),{locale:this.locale}):F.isDateTime(a)?a:a instanceof Date?F.fromJSDate(a,{locale:this.locale}):F.local()}}class Ga extends Ft{constructor(){super(...arguments);Pe(this,"dayNames",["S","M","T","W","T","F","S"]);Pe(this,"getWeekdays",()=>this.dayNames);Pe(this,"getWeekArray",n=>{const t=n.endOf("month").plus({days:1}).endOf("week"),r=n.startOf("month").startOf("week").minus({days:1}),i=t.diff(r,"days").days,l=[];return new Array(Math.round(i)).fill(0).map((o,d)=>d).map(o=>r.plus({days:o})).forEach((o,d)=>{if(d===0||d%7===0&&d>6){l.push([o]);return}l[l.length-1].push(o)}),l.filter(o=>o.some(d=>d.month===n.month))})}}const Ha=s=>Object.entries(s),Za=()=>{const s=()=>{const n={x:0,y:0,bottom:0,height:0,left:0,right:0,top:0,width:0};return{...n,toJSON:()=>n}};class a extends Array{item(t){return this[t]}}document.elementFromPoint=()=>null,HTMLElement.prototype.getBoundingClientRect=s,HTMLElement.prototype.getClientRects=()=>new a,Range.prototype.getBoundingClientRect=s,Range.prototype.getClientRects=()=>new a},Ba=s=>{const a=new Ms({defaultOptions:{queries:{retry:!1,refetchOnMount:!1,refetchOnWindowFocus:!1,staleTime:1/0}}});return s.forEach(({key:n,data:t})=>{a.setQueryData(n,t)}),a},Gt=s=>{if(s!=null&&s.first_name&&(s!=null&&s.last_name))return`${s.first_name} ${s.last_name}`;if(s!=null&&s.first_name)return s.first_name;if(s!=null&&s.principal_name)return s.principal_name},Ht=`Your user role does not grant permission to view the file ingest jobs details. Please
    contact your administrator for details.`,ts="file-upload-permission",Zt="Unable to fetch file upload jobs. Please try again.",Bt="file-upload-error",fs=({page:s,rowsPerPage:a})=>{const{checkPermission:n}=ge(),t=n(fe.GRAPH_DB_INGEST),{addNotification:r,dismissNotification:i}=de();return v.useEffect(()=>(t||r(Ht,ts,is),()=>i(ts)),[r,i,t]),Y({onError:()=>r(Zt,Bt),queryFn:()=>P.listFileIngestJobs(a*s,a,"-id").then(l=>l.data),queryKey:Us.listJobsPaginated(s,a),refetchInterval:5e3,enabled:t})},Qa=({filters:s={},page:a,rowsPerPage:n})=>{const{checkPermission:t,isSuccess:r}=ge(),i=r&&t(fe.CLIENTS_MANAGE),{addNotification:l,dismissNotification:o}=de();return v.useEffect(()=>(r&&!i&&l(Mt,ss,is),()=>o(ss)),[l,o,i,r]),Y({enabled:!!(r&&i),keepPreviousData:!0,onError:()=>l(Ut,Lt),queryFn:({signal:d})=>P.getFinishedJobs({...s,skip:n*a,limit:n,hydrate_domains:!1,hydrate_ous:!1},{signal:d}).then(g=>g.data),queryKey:["finished-jobs",{...s,page:a,rowsPerPage:n}]})},qa=s=>{const[a,n]=v.useState(s),t=v.useCallback(i=>{n(l=>({...l,...i}))},[]),r=v.useCallback((...i)=>{i.length!==0&&n(l=>{const o={...l};for(const d of i)delete o[d];return o})},[]);return{applyState:t,deleteKeys:r,setState:n,state:a}},xs=()=>Y({queryKey:["getRoles"],queryFn:({signal:s})=>P.getRoles({signal:s}).then(a=>{var n,t;return(t=(n=a.data)==null?void 0:n.data)==null?void 0:t.roles})}),Qt=(s,a)=>s!==null?parseInt(s):a,qt=()=>{var g;const[s,a]=Ls(),n=os("tier_management_engine"),{tagId:t,isLoading:r,isError:i}=ks(),l=v.useCallback(y=>Fs(a,["assetGroupTagId"])(y),[a]),o=new URLSearchParams;if(r||i||n.isLoading||n.isError||!((g=n.data)!=null&&g.enabled))return{assetGroupTagId:void 0,params:o,setZoneQueryParams:l};const d=Qt(s.get("assetGroupTagId"),t);return typeof d=="number"&&o.append("asset_group_tag_id",d.toString()),{assetGroupTagId:d,params:o,setZoneQueryParams:l}},Wt=0,$t="Hygiene",Wa=()=>{const s=Gs().data??[],{assetGroupTagId:a}=qt();if(a===Wt)return $t;const n=s.find(t=>t.id===a);return n?n.name:"Tier Zero"},Kt=({menuTitle:s,menuItems:a,disabled:n})=>{const t=Fe.useRef(null),[r,i]=Fe.useState(!1),l=()=>{i(!0)},o=()=>{i(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(w,{"aria-controls":"create-menu","aria-haspopup":"true",ref:t,onClick:l,disabled:n,children:e.jsxs(U,{display:"flex",alignItems:"center",children:[e.jsx(M,{mr:"8px",children:s}),e.jsx(Ie,{icon:Hs})]})}),e.jsx(Zs,{id:"create-menu",anchorEl:t.current,keepMounted:!0,open:r,onClose:o,children:a.map(d=>e.jsx(V,{onClick:()=>{d.onClick(),o()},children:d.title},d.title))})]})},as=({menuTitle:s,menuItems:a,disabled:n})=>a.length>1?e.jsx(Kt,{menuItems:a,menuTitle:s,disabled:n}):a.length===1?e.jsx(w,{disabled:n,onClick:()=>{a[0].onClick()},children:a[0].title}):null,zt=({createMenuTitle:s,menuItems:a,featureFlag:n,featureFlagEnabledMenuItems:t,disabled:r=!1})=>{const i=e.jsx(as,{menuTitle:s,menuItems:a,disabled:r});if(n!==void 0&&t){const l=e.jsx(as,{menuTitle:s,menuItems:t,disabled:r});return e.jsx(gs,{flagKey:n,enabled:l,disabled:i})}else return i},Yt=({onCancel:s,onSubmit:a,isLoading:n,error:t})=>{var C,E;const{control:r,handleSubmit:i,setValue:l,formState:{errors:o},setError:d}=Oe({defaultValues:{emailAddress:"",principal:"",firstName:"",lastName:"",password:"",needsPasswordReset:!1,roles:[1],SSOProviderId:""}}),[g,y]=Fe.useState("password");v.useEffect(()=>{var p,x,S,f,c,m,_;g==="password"&&l("SSOProviderId",void 0),t&&(((p=t==null?void 0:t.response)==null?void 0:p.status)===409?(f=(S=(x=t.response)==null?void 0:x.data)==null?void 0:S.errors[0])!=null&&f.message.toLowerCase().includes("principal name")?d("principal",{type:"custom",message:"Principal name is already in use."}):(_=(m=(c=t.response)==null?void 0:c.data)==null?void 0:m.errors[0])!=null&&_.message.toLowerCase().includes("email")?d("emailAddress",{type:"custom",message:"Email is already in use."}):d("root.generic",{type:"custom",message:"A conflict has occured."}):d("root.generic",{type:"custom",message:"An unexpected error occurred. Please try again."}))},[g,l,t,d]);const u=xs(),h=Y(["listSSOProviders"],({signal:p})=>P.listSSOProviders({signal:p}).then(x=>{var S;return(S=x.data)==null?void 0:S.data})),T=p=>{p.preventDefault(),s()};return e.jsx("form",{autoComplete:"off",onSubmit:i(a),children:!(u.isLoading||h.isLoading)&&e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsxs(b,{container:!0,spacing:2,children:[e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"emailAddress",control:r,rules:{required:"Email Address is required",maxLength:{value:De,message:`Email address must be less than ${De} characters`},pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"Please follow the example@domain.com format"}},render:({field:p})=>{var x;return e.jsx(G,{...p,variant:"standard",id:"emailAddress",label:"Email Address",type:"email",fullWidth:!0,error:!!o.emailAddress,helperText:(x=o.emailAddress)==null?void 0:x.message,"data-testid":"create-user-dialog_input-email-address"})}})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"principal",control:r,rules:{required:"Principal Name is required",maxLength:{value:z,message:`Principal Name must be less than ${z} characters`},minLength:{value:K,message:`Principal Name must be ${K} characters or more`},validate:p=>{const x=p.trim();return p!==x?"Principal Name does not allow leading or trailing spaces":!0}},render:({field:p})=>{var x;return e.jsx(G,{...p,variant:"standard",id:"principal",label:"Principal Name",fullWidth:!0,error:!!o.principal,helperText:(x=o.principal)==null?void 0:x.message,"data-testid":"create-user-dialog_input-principal-name"})}})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"firstName",control:r,rules:{required:"First Name is required",maxLength:{value:z,message:`First Name must be less than ${z} characters`},minLength:{value:K,message:`First Name must be ${K} characters or more`},validate:p=>{const x=p.trim();return p!==x?"First Name does not allow leading or trailing spaces":!0}},render:({field:p})=>{var x;return e.jsx(G,{...p,variant:"standard",id:"firstName",label:"First Name",fullWidth:!0,error:!!o.firstName,helperText:(x=o.firstName)==null?void 0:x.message,"data-testid":"create-user-dialog_input-first-name"})}})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"lastName",control:r,rules:{required:"Last Name is required",maxLength:{value:z,message:`Last Name must be less than ${z} characters`},minLength:{value:K,message:`Last Name must be ${K} characters or more`},validate:p=>{const x=p.trim();return p!==x?"Last Name does not allow leading or trailing spaces":!0}},render:({field:p})=>{var x;return e.jsx(G,{...p,variant:"standard",id:"lastName",label:"Last Name",fullWidth:!0,error:!!o.lastName,helperText:(x=o.lastName)==null?void 0:x.message,"data-testid":"create-user-dialog_input-last-name"})}})}),e.jsxs(e.Fragment,{children:[e.jsx(b,{item:!0,xs:12,children:e.jsxs(ue,{children:[e.jsx(me,{id:"authenticationMethod-label",sx:{ml:"-14px",mt:"8px"},children:"Authentication Method"}),e.jsxs(he,{labelId:"authenticationMethod-label",id:"authenticationMethod",name:"authenticationMethod",onChange:p=>y(p.target.value),value:g,variant:"standard",fullWidth:!0,"data-testid":"create-user-dialog_select-authentication-method",children:[e.jsx(V,{value:"password",children:"Username / Password"}),h.data&&((C=h.data)==null?void 0:C.length)>0&&e.jsx(V,{value:"sso",children:"Single Sign-On (SSO)"})]})]})}),g==="password"?e.jsxs(e.Fragment,{children:[e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"password",control:r,defaultValue:"",rules:{required:"Password is required",minLength:{value:12,message:"Password must be at least 12 characters long"},pattern:{value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])/,message:"Password must contain at least 1 lowercase character, 1 uppercase character, 1 number and 1 special character (!@#$%^&*)"},maxLength:{value:1e3,message:"Password must be less than 1000 characters"}},render:({field:p})=>{var x;return e.jsx(G,{...p,variant:"standard",id:"password",label:"Initial Password",type:"password",fullWidth:!0,error:!!o.password,helperText:(x=o.password)==null?void 0:x.message,"data-testid":"create-user-dialog_input-password"})}})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"needsPasswordReset",control:r,defaultValue:!1,render:({field:p})=>e.jsx(Ge,{control:e.jsx(Bs,{...p,onChange:(x,S)=>p.onChange(S),color:"primary","data-testid":"create-user-dialog_checkbox-needs-password-reset"}),label:"Force Password Reset?"})})})]}):e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"SSOProviderId",control:r,rules:{required:"SSO Provider is required"},render:({field:{onChange:p,onBlur:x,value:S,ref:f}})=>{var c,m;return e.jsxs(ue,{error:!!o.SSOProviderId,children:[e.jsx(me,{id:"SSOProviderId-label",sx:{ml:"-14px",mt:"8px"},children:"SSO Provider"}),e.jsx(he,{onChange:p,defaultValue:"",onBlur:x,value:S,ref:f,labelId:"SSOProviderId-label",id:"SSOProviderId",name:"SSOProviderId",variant:"standard",fullWidth:!0,"data-testid":"create-user-dialog_select-sso-provider",children:(c=h.data)==null?void 0:c.map(_=>e.jsx(V,{value:_.id,children:_.name},_.id))}),e.jsx(He,{children:(m=o.SSOProviderId)==null?void 0:m.message})]})}})})]}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"roles.0",control:r,defaultValue:1,rules:{required:"Role is required"},render:({field:p})=>{var x;return e.jsxs(ue,{children:[e.jsx(me,{id:"role-label",sx:{ml:"-14px",mt:"8px"},children:"Role"}),e.jsx(he,{labelId:"role-label",id:"role",name:"role",onChange:S=>{const f=parseInt(S.target.value,10);p.onChange(isNaN(f)?1:f)},value:isNaN(p.value)?"":p.value.toString(),variant:"standard",fullWidth:!0,"data-testid":"create-user-dialog_select-role",children:u.isLoading?e.jsx(V,{value:1,children:"Loading..."}):(x=u.data)==null?void 0:x.map(S=>e.jsx(V,{value:S==null?void 0:S.id.toString(),children:S==null?void 0:S.name},S==null?void 0:S.id))})]})}})}),!!((E=o.root)!=null&&E.generic)&&e.jsx(b,{item:!0,xs:12,children:e.jsx(xe,{severity:"error",children:o.root.generic.message})})]})}),e.jsxs(q,{children:[e.jsx(w,{type:"button",variant:"tertiary",onClick:T,disabled:n,"data-testid":"create-user-dialog_button-close",children:"Cancel"}),e.jsx(w,{type:"submit",disabled:n,"data-testid":"create-user-dialog_button-save",children:"Save"})]})]})})},Vt=({open:s,onClose:a,onExited:n,onSave:t,isLoading:r,error:i})=>{const l=o=>{let d;o.SSOProviderId&&(d=parseInt(o.SSOProviderId)),t({...o,SSOProviderId:d}).then(()=>{a()}).catch(g=>console.error(g))};return e.jsxs(re,{open:s,fullWidth:!0,maxWidth:"sm",onClose:a,disableEscapeKeyDown:!0,PaperProps:{"data-testid":"create-user-dialog"},TransitionProps:{onExited:n},children:[e.jsx(ne,{children:"Create User"}),e.jsx(Yt,{onCancel:a,onSubmit:l,isLoading:r,error:i})]})},qe=({headers:s,data:a,isLoading:n=!1,showPaginationControls:t=!1,paginationProps:r={page:1,rowsPerPage:10,count:10,onPageChange:()=>{},onRowsPerPageChange:()=>{}}})=>e.jsxs(e.Fragment,{children:[e.jsx(Qs,{children:e.jsxs(ls,{children:[e.jsx(ds,{children:e.jsx(le,{children:s.map((i,l)=>e.jsx(Q,{align:i.alignment,children:i.label},l))})}),e.jsx(cs,{children:n?e.jsx(le,{children:s.map((i,l)=>e.jsx(Q,{children:e.jsx(us,{})},l))}):a==null?void 0:a.map((i,l)=>e.jsx(le,{children:i.map((o,d)=>{var g,y;return e.jsx(Q,{align:(g=s[d])==null?void 0:g.alignment,sx:{verticalAlign:((y=s[d])==null?void 0:y.verticalAlign)??""},children:o},d)})},l))})]})}),t&&e.jsx(bt,{rowsPerPageOptions:[5,10,25,100],component:"div",...r})]}),Ss=({open:s,onClose:a,onCancel:n,onSave:t,error:r,secret:i,onSecretChange:l,contentText:o})=>{const d=g=>{g.preventDefault(),t(i)};return e.jsxs(re,{open:s,onClose:a,maxWidth:"sm",fullWidth:!0,children:[e.jsx(ne,{children:"Disable Multi-Factor Authentication?"}),e.jsxs("form",{onSubmit:d,children:[e.jsxs(J,{children:[e.jsx(xe,{severity:"warning",style:{marginBottom:"10px",alignItems:"center"},children:"Disabling MFA increases the risk of unauthorized access. For optimal account security, we highly recommend keeping MFA enabled."}),e.jsx(pe,{children:o}),e.jsx(G,{id:"secret",name:"secret",value:i,onChange:l,type:"password",label:"Password",variant:"outlined",margin:"dense",fullWidth:!0,autoFocus:!0,error:!!r,helperText:r})]}),e.jsxs(q,{children:[e.jsx(w,{type:"button",variant:"tertiary",onClick:n,children:"Cancel"}),e.jsx(w,{type:"submit",children:"Disable Multi-Factor Authentication"})]})]})]})},Jt={good:"fill-[#BCD3A8]",bad:"fill-[#D9442E]",pending:"fill-[#5CC3AD]"},Xt=({label:s="",pulse:a=!1,status:n})=>{const t=Jt[n];return e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx("span",{className:"mr-1.5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:e.jsx("circle",{cx:"6",cy:"6",r:"6",className:qs(t,a&&"animate-pulse")})})}),s&&e.jsx("span",{children:s})]})},ea=["ID / User / Status","Status Message","Start Time","Duration","File Information"],sa=s=>s.map(a=>({label:a,verticalAlign:"baseline"})),ta=s=>{const[a,n,t]=$s(s.start_time).split(" ",3),r=Nt[s.status],i=It[s.status];return[e.jsxs("div",{className:"min-w-32 space-y-2",children:[e.jsxs("div",{className:"text-primary",children:["ID ",s.id]}),e.jsx("div",{children:s.user_email_address}),e.jsx("div",{className:"flex items-center",children:e.jsx(Xt,{...r,label:i})})]},`status-${s.id}`),e.jsx("div",{className:"max-w-40",children:s.status_message},`message-${s.id}`),e.jsxs("div",{className:"min-w-20",children:[e.jsx("div",{children:a}),e.jsxs("div",{children:[n," ",t]})]},`start-${s.id}`),e.jsx("div",{children:ms(s.start_time,s.end_time)},`duration-${s.id}`),e.jsxs("div",{className:"min-w-32 max-w-48",children:[s.total_files," Files"]},`collected-${s.id}`)]},aa=()=>{const[s,a]=v.useState(0),[n,t]=v.useState(10),{data:r,isLoading:i}=fs({page:s,rowsPerPage:n}),l=(r==null?void 0:r.data)??[],o=(r==null?void 0:r.count)??0;return e.jsx(Ws,{children:e.jsx(qe,{data:l.map(ta),headers:sa(ea),isLoading:i,paginationProps:{page:s,rowsPerPage:n,count:o,onPageChange:(d,g)=>a(g),onRowsPerPageChange:d=>t(parseInt(d.target.value))},showPaginationControls:!0})})},ra={[-1]:"Invalid",0:"Ready",1:"Running",2:"Complete",3:"Canceled",4:"Timed Out",5:"Failed",6:"Ingesting",7:"Analyzing",8:"Partially Complete"},na=[{label:"User"},{label:"Start Time"},{label:"End Time"},{label:"Duration"},{label:"Status"},{label:"Status Message"}],ia=()=>{var y;const[s,a]=v.useState(0),[n,t]=v.useState(10),[r,i]=v.useState(0),{data:l}=fs({page:s,rowsPerPage:n});v.useEffect(()=>i((l==null?void 0:l.count)||0),[l]);const o=(u,h)=>{a(h)},d=u=>{t(parseInt(u.target.value,10)),a(0)},g=((y=l==null?void 0:l.data)==null?void 0:y.sort((u,h)=>h.id-u.id).map(u=>[u.user_email_address,F.fromISO(u.start_time).toFormat(ae.DATETIME_WITH_LINEBREAKS),u.end_time===Je?"":F.fromISO(u.end_time).toFormat(ae.DATETIME_WITH_LINEBREAKS),u.end_time===Je?"":ms(u.start_time,u.end_time),ra[u.status],u.status_message]))||[];return e.jsx(_e,{children:e.jsx(qe,{headers:na,data:g,showPaginationControls:!0,paginationProps:{page:s,rowsPerPage:n,count:r,onPageChange:o,onRowsPerPageChange:d}})})},$a=()=>{const{setShowFileIngestDialog:s}=Ks(),{checkPermission:a}=ge(),n=a(fe.GRAPH_DB_INGEST),{addNotification:t,dismissNotification:r}=de(),i="file-upload-permission";Be(()=>(n||t("Your user role does not grant permission to upload data. Please contact your administrator for details.",i,{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}}),()=>r(i)));const o=()=>s(d=>!d);return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{title:"File Ingest","data-testid":"manual-file-ingest",pageDescription:e.jsxs(M,{variant:"body2",children:["Upload data from SharpHound or AzureHound offline collectors. Check out our"," ",Ze.fileIngestLink," documentation for more information."]})}),e.jsx(U,{display:"flex",justifyContent:"flex-end",alignItems:"center",minHeight:"24px",my:2,children:e.jsx(w,{onClick:()=>o(),"data-testid":"file-ingest_button-upload-files",disabled:!n,children:"Upload File(s)"})}),e.jsx(gs,{flagKey:"open_graph_phase_2",loadingFallback:e.jsx(vt,{loading:!0}),enabled:e.jsx(aa,{}),disabled:e.jsx(ia,{})})]})},ce=({label:s,valueToCopy:a,hoverOnly:n=!1})=>{const t=je(),[r,i]=v.useState(!1),[l,o]=v.useState(!1),d=()=>o(!0),g=()=>o(!1),y=async()=>{i(!0),await Vs(a),setTimeout(()=>{i(!1)},1e3)};return e.jsxs(U,{display:"flex",alignItems:"center",onMouseEnter:d,onMouseLeave:g,sx:{height:t.spacing(3)},children:[s,e.jsx(hs,{title:"Copied",open:r,placement:"right",children:e.jsx(zs,{onClick:y,sx:{fontSize:"inherit",display:!n||l?void 0:"none"},children:e.jsx(Ie,{icon:Ys})})})]})},rs="yyyy-mm-dd",Ka={isAfterDate:(s,a)=>({rule:n=>!s||!n?!0:n.getTime()>=s.getTime(),errorMessage:a}),isBeforeDate:(s,a)=>({rule:n=>!s||!n?!0:s.getTime()>=n.getTime(),errorMessage:a})},oa=(s,a=[],n)=>{const t=a.reduce((i,{rule:l,errorMessage:o})=>(l(s)||i.push(o),i),[]),r=t.length>0;return r&&n(t),!r},za=({fromDate:s=et(),hint:a=rs,onDateChange:n,onValidation:t,toDate:r=Xs(),validations:i=[],value:l})=>{const[o,d]=v.useState(a),[g,y]=v.useState(l?F.fromJSDate(l).toFormat(ae.ISO_8601):""),[u,h]=v.useState(l),[T,C]=v.useState("");v.useEffect(()=>{l===void 0&&(y(""),h(void 0))},[l]);const E=c=>C(c[0]),p=c=>{const m=c.target.value;if(y(m),C(""),m===""){n(),h(void 0),t==null||t(!0);return}const _=F.fromFormat(m,ae.ISO_8601);_.isValid&&(t==null||t(!0),h(_.toJSDate()))},x=()=>{if(g!==""&&!F.fromFormat(g,ae.ISO_8601).isValid){C("Input is not a valid date."),t==null||t(!1);return}d(a),S(u)},S=c=>{C(""),c!==void 0&&(h(c),y(F.fromJSDate(c).toFormat(ae.ISO_8601)),oa(c,i,E)?(n(c),t==null||t(!0)):t==null||t(!1))},f=v.useId();return e.jsxs(e.Fragment,{children:[e.jsx(Js,{className:"bg-transparent dark:bg-transparent pl-2",onChange:p,onFocus:()=>d(rs),onBlur:x,placeholder:o,value:g,variant:"underlined","aria-invalid":!!T,"aria-describedby":T?f:void 0,calendarProps:{fromDate:s,mode:"single",onSelect:S,selected:u,toDate:r}}),T&&e.jsx("span",{className:"text-error text-sm",id:f,children:T})]})},Ya=({open:s,children:a})=>e.jsx(st,{open:s,onOpenChange:()=>{document.body.style.pointerEvents=""},children:e.jsx(tt,{children:e.jsxs(at,{className:"outline-none focus:outline-none",children:[e.jsx(rt,{children:"No Data Available"}),e.jsx(nt,{children:a})]})})}),la=({samlProviderDetails:s})=>e.jsxs(e.Fragment,{children:[e.jsx(se,{label:e.jsx(ce,{label:"IdP SSO URL",valueToCopy:s.idp_sso_uri,hoverOnly:!0}),value:s.idp_sso_uri}),e.jsx(se,{label:e.jsx(ce,{label:"BHE SSO URL",valueToCopy:s.sp_sso_uri,hoverOnly:!0}),value:s.sp_sso_uri}),e.jsx(se,{label:e.jsx(ce,{label:"BHE ACS URL",valueToCopy:s.sp_acs_uri,hoverOnly:!0}),value:s.sp_acs_uri}),e.jsx(se,{label:e.jsx(ce,{label:"BHE Metadata URL",valueToCopy:s.sp_metadata_uri,hoverOnly:!0}),value:s.sp_metadata_uri})]}),da=({ssoProvider:s})=>{const a=s.details;return e.jsxs(e.Fragment,{children:[e.jsx(se,{label:e.jsx(ce,{label:"Client ID",valueToCopy:a.client_id,hoverOnly:!0}),value:a.client_id}),e.jsx(se,{label:e.jsx(ce,{label:"Issuer",valueToCopy:a.issuer,hoverOnly:!0}),value:a.issuer}),e.jsx(se,{label:e.jsx(ce,{label:"Callback URL",valueToCopy:s.callback_uri,hoverOnly:!0}),value:s.callback_uri})]})},ca=({ssoProvider:s,roles:a})=>{var g,y,u,h,T,C,E,p;const n=je(),t=it(),r=ot(),{addNotification:i}=de(),l=v.useMemo(()=>{var x;return(x=a==null?void 0:a.find(S=>{var f,c;return S.id===((c=(f=s.config)==null?void 0:f.auto_provision)==null?void 0:c.default_role_id)}))==null?void 0:x.name},[a,(y=(g=s.config)==null?void 0:g.auto_provision)==null?void 0:y.default_role_id]);if(!s.type)return null;let o;switch(s.type.toLowerCase()){case"saml":o=e.jsx(la,{samlProviderDetails:s.details});break;case"oidc":o=e.jsx(da,{ssoProvider:s});break;default:o=null}const d=()=>{s.type.toLowerCase()=="oidc"?i("Only SAML providers support signing certificates.","errorDownloadSAMLSigningCertificate"):P.getSAMLProviderSigningCertificate(s.id).then(x=>{var f,c;const S=((c=(f=x.headers["content-disposition"])==null?void 0:f.match(/^.*filename="(.*)"$/))==null?void 0:c[1])||`${s.name}-signing-certificate`;dt(x.data,S)}).catch(x=>{console.error(x),i("This file could not be downloaded. Please try again.","downloadSAMLSigningCertificate")})};return e.jsxs(e.Fragment,{children:[e.jsx(U,{className:t.container,"data-testid":"sso_provider-info-panel",children:e.jsxs(_e,{children:[e.jsxs(U,{className:r.header,sx:{backgroundColor:n.palette.neutral.quinary},children:[e.jsx(U,{sx:{backgroundColor:n.palette.primary.main,width:10,height:n.spacing(7),mr:n.spacing(1)}}),e.jsx(M,{"data-testid":"sso_provider-info-panel_header-text",variant:"h5",noWrap:!0,sx:{color:n.palette.text.primary,flexGrow:1},children:s==null?void 0:s.name})]}),e.jsxs(_e,{elevation:0,sx:{backgroundColor:n.palette.neutral.secondary,overflowX:"hidden",overflowY:"auto",padding:n.spacing(1,2),pointerEvents:"auto","& > div.node:nth-of-type(odd)":{background:n.palette.neutral.tertiary}},children:[e.jsx(U,{flexShrink:0,flexGrow:1,fontWeight:"bold",ml:n.spacing(1),fontSize:"small",children:"Provider Information:"}),e.jsxs(lt,{children:[o,e.jsx(se,{label:e.jsx(Le,{children:"Automatically create new users on login"}),value:(h=(u=s.config)==null?void 0:u.auto_provision)!=null&&h.enabled?"Yes":"No"}),((C=(T=s.config)==null?void 0:T.auto_provision)==null?void 0:C.enabled)&&e.jsxs(e.Fragment,{children:[e.jsx(se,{label:e.jsx(Le,{children:"Allow SSO provider to manage roles for new users"}),value:(p=(E=s.config)==null?void 0:E.auto_provision)!=null&&p.role_provision?"Yes":"No"}),e.jsx(se,{label:e.jsx(Le,{children:"Default role when creating new users"}),value:l??"Read-Only"})]})]})]})]})}),s.type.toLowerCase()==="saml"&&e.jsx(U,{mt:n.spacing(1),justifyContent:"center",display:"flex",children:e.jsx(w,{"aria-label":`Download ${s.name} SP Certificate`,variant:"secondary",onClick:d,children:"Download SAML SP Certificate"})})]})},ns=({text:s,fallback:a})=>typeof s!="string"||s.trim()===""?e.jsx("em",{children:a}):e.jsx(e.Fragment,{children:s}),ua=({onCancel:s,onSubmit:a,userId:n,hasSelectedSelf:t,isLoading:r,error:i})=>{var g,y;const l=Y(["getUser",n],({signal:u})=>P.getUser(n,{signal:u}).then(h=>h.data.data),{cacheTime:0}),o=xs(),d=Y(["listSSOProviders"],({signal:u})=>P.listSSOProviders({signal:u}).then(h=>h.data.data));return l.isLoading||o.isLoading||d.isLoading?e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsx(pe,{children:e.jsx(us,{})})}),e.jsx(q,{children:e.jsx(q,{children:e.jsx(w,{type:"button",variant:"tertiary",onClick:s,"data-testid":"update-user-dialog_button-close",children:"Close"})})})]}):l.isError||o.isError||d.isError?e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsx(pe,{children:"User not found."})}),e.jsx(q,{children:e.jsx(q,{children:e.jsx(w,{type:"button",variant:"tertiary",onClick:s,"data-testid":"update-user-dialog_button-close",children:"Close"})})})]}):e.jsx(ma,{onCancel:s,onSubmit:a,initialData:{emailAddress:l.data.email_address||"",principal:l.data.principal_name||"",firstName:l.data.first_name||"",lastName:l.data.last_name||"",SSOProviderId:((g=l.data.sso_provider_id)==null?void 0:g.toString())||"",roles:((y=l.data.roles)==null?void 0:y.map(u=>u.id))||[]},roles:o.data,SSOProviders:d.data,hasSelectedSelf:t,isLoading:r,error:i})},ma=({onCancel:s,onSubmit:a,initialData:n,roles:t,SSOProviders:r,hasSelectedSelf:i,isLoading:l,error:o})=>{var p,x,S,f;const{control:d,handleSubmit:g,setValue:y,formState:{errors:u},setError:h,watch:T}=Oe({defaultValues:{...n,authenticationMethod:n.SSOProviderId?"sso":"password"}}),C=T("authenticationMethod"),E=!!((S=(x=(p=r==null?void 0:r.find(({id:c})=>c===Number(T("SSOProviderId"))))==null?void 0:p.config)==null?void 0:x.auto_provision)!=null&&S.role_provision);return v.useEffect(()=>{var c,m,_,D,A;if(C==="password"&&y("SSOProviderId",void 0),o){const B=(_=(m=(c=o.response)==null?void 0:c.data)==null?void 0:m.errors[0])==null?void 0:_.message.toLowerCase();((D=o.response)==null?void 0:D.status)===400?B.includes("role provision enabled")&&h("root.generic",{type:"custom",message:"Cannot modify user roles for role provision enabled SSO providers."}):((A=o.response)==null?void 0:A.status)===409?B.includes("principal name")?h("principal",{type:"custom",message:"Principal name is already in use."}):B.includes("email")?h("emailAddress",{type:"custom",message:"Email is already in use."}):h("root.generic",{type:"custom",message:"A conflict has occured."}):h("root.generic",{type:"custom",message:"An unexpected error occurred. Please try again."})}},[C,y,o,h]),e.jsxs("form",{autoComplete:"off",onSubmit:g(a),children:[e.jsx(J,{children:e.jsxs(b,{container:!0,spacing:1,children:[e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"emailAddress",control:d,rules:{required:"Email Address is required",maxLength:{value:De,message:`Email address must be less than ${De} characters`},pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"Please follow the example@domain.com format"}},render:({field:c})=>{var m;return e.jsx(G,{...c,variant:"standard",id:"emailAddress",label:"Email Address",type:"email",fullWidth:!0,error:!!u.emailAddress,helperText:(m=u.emailAddress)==null?void 0:m.message,"data-testid":"update-user-dialog_input-email-address"})}})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"principal",control:d,rules:{required:"Principal Name is required",maxLength:{value:z,message:`Principal Name must be less than ${z} characters`},minLength:{value:K,message:`Principal Name must be ${K} characters or more`},validate:c=>{const m=c.trim();return c!==m?"Principal Name does not allow leading or trailing spaces":!0}},render:({field:c})=>{var m;return e.jsx(G,{...c,variant:"standard",id:"principal",label:"Principal Name",fullWidth:!0,error:!!u.principal,helperText:(m=u.principal)==null?void 0:m.message,"data-testid":"update-user-dialog_input-principal-name"})}})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"firstName",control:d,rules:{required:"First Name is required",maxLength:{value:z,message:`First Name must be less than ${z} characters`},minLength:{value:K,message:`First Name must be ${K} characters or more`},validate:c=>{const m=c.trim();return c!==m?"First Name does not allow leading or trailing spaces":!0}},render:({field:c})=>{var m;return e.jsx(G,{...c,variant:"standard",id:"firstName",label:"First Name",fullWidth:!0,error:!!u.firstName,helperText:(m=u.firstName)==null?void 0:m.message,"data-testid":"update-user-dialog_input-first-name"})}})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"lastName",control:d,rules:{required:"Last Name is required",maxLength:{value:z,message:`Last Name must be less than ${z} characters`},minLength:{value:K,message:`Last Name must be ${K} characters or more`},validate:c=>{const m=c.trim();return c!==m?"Last Name does not allow leading or trailing spaces":!0}},render:({field:c})=>{var m;return e.jsx(G,{...c,variant:"standard",id:"lastName",label:"Last Name",fullWidth:!0,error:!!u.lastName,helperText:(m=u.lastName)==null?void 0:m.message,"data-testid":"update-user-dialog_input-last-name"})}})}),e.jsxs(e.Fragment,{children:[e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"authenticationMethod",control:d,rules:{required:"Authentication Method is required"},render:({field:{onChange:c,onBlur:m,value:_,ref:D}})=>e.jsxs(ue,{children:[e.jsx(me,{id:"authenticationMethod-label",sx:{ml:"-14px",mt:"8px"},hidden:i,children:"Authentication Method"}),e.jsxs(he,{onChange:c,onBlur:m,value:_,ref:D,labelId:"authenticationMethod-label",id:"authenticationMethod",name:"authenticationMethod",variant:"standard",fullWidth:!0,"data-testid":"update-user-dialog_select-authentication-method",hidden:i,children:[e.jsx(V,{value:"password",children:"Username / Password"}),r&&r.length>0&&e.jsx(V,{value:"sso",children:"Single Sign-On (SSO)"})]})]})})}),C==="sso"&&e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"SSOProviderId",control:d,rules:{required:"SSO Provider is required"},render:({field:{onChange:c,onBlur:m,value:_,ref:D}})=>e.jsxs(ue,{children:[e.jsx(me,{id:"SSOProviderId-label",sx:{ml:"-14px",mt:"8px"},hidden:i,children:"SSO Provider"}),e.jsx(he,{onChange:c,onBlur:m,value:_==null?void 0:_.toString(),ref:D,defaultValue:"",labelId:"SSOProviderId-label",id:"SSOProviderId",name:"SSOProviderId",variant:"standard",fullWidth:!0,"data-testid":"update-user-dialog_select-sso-provider",hidden:i,children:r==null?void 0:r.map(A=>e.jsx(V,{value:A.id.toString(),children:A.name},A.id))})]})})})]}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{name:"roles.0",control:d,defaultValue:1,rules:{required:"Role is required"},render:({field:c})=>e.jsxs(ue,{children:[e.jsx(me,{id:"role-label",sx:{ml:"-14px",mt:"8px"},hidden:i,children:"Role"}),e.jsx(he,{labelId:"role-label",id:"role",name:"role",onChange:m=>{const _=parseInt(m.target.value,10);c.onChange(isNaN(_)?1:_)},value:isNaN(c.value)?"":c.value.toString(),variant:"standard",fullWidth:!0,disabled:E,"data-testid":"update-user-dialog_select-role",hidden:i,children:t==null?void 0:t.map(m=>e.jsx(V,{value:m.id.toString(),children:m.name},m.id))}),E&&e.jsx(He,{id:"role-helper-text",children:"SSO Provider has enabled role provision."})]})})}),!!((f=u.root)!=null&&f.generic)&&e.jsx(b,{item:!0,xs:12,children:e.jsx(xe,{severity:"error",children:u.root.generic.message})})]})}),e.jsxs(q,{children:[e.jsx(w,{type:"button",variant:"tertiary",onClick:s,disabled:l,"data-testid":"update-user-dialog_button-close",children:"Cancel"}),e.jsx(w,{type:"submit",disabled:l,"data-testid":"update-user-dialog_button-save",children:"Save"})]})]})},ha=({open:s,onClose:a,onExited:n,userId:t,onSave:r,hasSelectedSelf:i,isLoading:l,error:o})=>{const d=g=>{let y;g.SSOProviderId&&(y=parseInt(g.SSOProviderId)),r({...g,SSOProviderId:y}).then(()=>{a()}).catch(u=>console.error(u))};return e.jsxs(re,{open:s,fullWidth:!0,maxWidth:"sm",onClose:a,disableEscapeKeyDown:!0,keepMounted:!1,PaperProps:{"data-testid":"update-user-dialog"},TransitionProps:{onExited:n},children:[e.jsx(ne,{children:"Update User"}),e.jsx(ua,{onCancel:a,onSubmit:d,userId:t,hasSelectedSelf:i,isLoading:l,error:o})]})},ys=(s,a)=>({auto_provision:a!=null&&a.auto_provision.enabled?a.auto_provision:{enabled:!1,default_role:s,role_provision:!1}}),bs=({control:s,errors:a,readOnlyRoleId:n,resetField:t,roles:r,watch:i})=>{var l,o,d,g,y;return e.jsxs(e.Fragment,{children:[e.jsx(b,{item:!0,xs:12,className:"mx-4 mb-4",children:e.jsx(I,{name:"config.auto_provision.enabled",control:s,defaultValue:!1,render:({field:u})=>e.jsx(Ge,{control:e.jsx(es,{checked:u.value,onCheckedChange:h=>{u.onChange(h),h||(t("config.auto_provision.role_provision"),t("config.auto_provision.default_role_id"))},"data-testid":"sso-provider-config-form_toggle-auto-provision"}),label:e.jsx(M,{className:Xe(`ml-4 ${!i("config.auto_provision.enabled")&&"dark:text-white dark:text-opacity-50 text-black text-opacity-40"}`),children:"Automatically create new users on login"})})})}),e.jsx(b,{item:!0,xs:12,className:"mx-4 mb-4",children:e.jsx(I,{name:"config.auto_provision.role_provision",control:s,defaultValue:!1,render:({field:u})=>e.jsx(Ge,{disabled:!i("config.auto_provision.enabled"),control:e.jsx(es,{checked:u.value,onCheckedChange:h=>u.onChange(h),"data-testid":"sso-provider-config-form_toggle-role-provision"}),label:e.jsx(M,{className:Xe(`ml-4 ${!i("config.auto_provision.role_provision")&&"dark:text-white dark:text-opacity-50 text-black text-opacity-40"}`),children:"Allow SSO Provider to modify roles"})})})}),e.jsx(b,{item:!0,xs:3,children:e.jsx(I,{name:"config.auto_provision.default_role_id",control:s,defaultValue:n,rules:{required:"Default role is required",validate:u=>u!=0||"Default role is required"},render:({field:u})=>e.jsxs(ue,{children:[e.jsx(me,{id:"role-label",className:"-ml-3.5 mt-2",disabled:!i("config.auto_provision.enabled"),children:"Default User Role"}),e.jsx(he,{disabled:!i("config.auto_provision.enabled"),labelId:"role-label",id:"role",name:"role",onChange:h=>{const T=parseInt(h.target.value,10);u.onChange(isNaN(T)?1:T)},value:isNaN(u.value)?"":u.value.toString(),variant:"standard",fullWidth:!0,"data-testid":"sso-provider-config-form_select-default-role",children:r==null?void 0:r.map(h=>e.jsx(V,{value:h.id.toString(),children:h.name},h.id))})]})})}),!!((o=(l=a.config)==null?void 0:l.auto_provision)!=null&&o.default_role_id)&&e.jsx(b,{item:!0,xs:5,children:e.jsx(xe,{severity:"error",children:(y=(g=(d=a.config)==null?void 0:d.auto_provision)==null?void 0:g.default_role_id)==null?void 0:y.message})})]})},pa=({error:s,onClose:a,oldSSOProvider:n,onSubmit:t,roles:r})=>{var x;const i=je(),l=v.useMemo(()=>{var S;return(S=r==null?void 0:r.find(f=>f.name==="Read-Only"))==null?void 0:S.id},[r]),{control:o,formState:{errors:d},handleSubmit:g,reset:y,resetField:u,setError:h,watch:T}=Oe({defaultValues:{name:(n==null?void 0:n.name)??"",metadata:void 0,config:ys(l,n==null?void 0:n.config)}}),[C,E]=v.useState("");v.useEffect(()=>{var S,f,c,m;s&&(((S=s==null?void 0:s.response)==null?void 0:S.status)===409?(m=(c=(f=s.response)==null?void 0:f.data)==null?void 0:c.errors[0])!=null&&m.message.toLowerCase().includes("sso provider name")?h("name",{type:"custom",message:"SSO Provider Name is already in use."}):h("root.generic",{type:"custom",message:"A conflict has occured."}):h("root.generic",{type:"custom",message:`Unable to ${n?"update":"create new"} SAML Provider configuration. Please try again.`}))},[s,h,n]);const p=()=>{a(),E(""),y()};return e.jsxs("form",{autoComplete:"off",onSubmit:g(t),children:[e.jsx(J,{children:e.jsxs(b,{container:!0,spacing:2,children:[e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{control:o,name:"name",rules:{required:"SAML Provider Name is required",pattern:{value:/^[a-z0-9]+(?:-[a-z0-9]+)*$/,message:'SAML Provider Name must be a valid URL slug (e.g., "saml-provider", "test-idp-01", "any-old-slug")'}},render:({field:S})=>{var f;return e.jsx(G,{...S,id:"name",variant:"standard",fullWidth:!0,name:"name",label:"SAML Provider Name",error:!!d.name,helperText:((f=d.name)==null?void 0:f.message)||"Choose a name for your SAML Provider configuration"})}})}),e.jsxs(b,{item:!0,xs:12,children:[e.jsx(I,{control:o,name:"metadata",rules:{required:!n&&"Metadata is required"},render:({field:S})=>{var f;return e.jsx(U,{p:1,borderRadius:4,bgcolor:i.palette.neutral.tertiary,children:e.jsxs(U,{display:"flex",flexDirection:"row",alignItems:"center",children:[e.jsxs(w,{variant:"secondary",children:[e.jsx("label",{htmlFor:"saml-provider-input",children:"Choose File"}),e.jsx("input",{id:"saml-provider-input",hidden:!0,type:"file",accept:".xml",value:C,onChange:c=>{E(c.target.value),S.onChange(c.target.files)},onBlur:S.onBlur})]}),e.jsx(U,{ml:1,children:e.jsx(M,{variant:"body1",children:(f=S.value)!=null&&f[0]?S.value[0].name:"No file chosen"})})]})})}}),e.jsx(He,{error:!!d.metadata,children:d.metadata?d.metadata.message:"Upload the Metadata file provided by your SAML Provider"})]}),e.jsx(bs,{control:o,errors:d,readOnlyRoleId:l,resetField:u,roles:r,watch:T}),!!((x=d.root)!=null&&x.generic)&&e.jsx(b,{item:!0,xs:12,children:e.jsx(xe,{severity:"error",children:d.root.generic.message})})]})}),e.jsxs(q,{children:[e.jsx(w,{type:"button",variant:"tertiary",onClick:p,"data-testid":"create-saml-provider-dialog_button-close",children:"Cancel"}),e.jsx(w,{"data-testid":"create-saml-provider-dialog_button-save",type:"submit",children:n?"Confirm Edits":"Submit"})]})]})},ga=({open:s,error:a,oldSSOProvider:n,onClose:t,onSubmit:r,roles:i})=>e.jsxs(re,{open:s,onClose:t,fullWidth:!0,maxWidth:"sm",PaperProps:{"data-testid":"create-saml-provider-dialog"},children:[e.jsxs(ne,{children:[n?"Edit":"Create"," SAML Provider"]}),e.jsx(pa,{error:a,onClose:t,oldSSOProvider:n,onSubmit:r,roles:i})]}),fa=({open:s,onCancel:a,onSubmit:n})=>{const{control:t,handleSubmit:r,formState:{errors:i}}=Oe({defaultValues:{token_name:""}}),l=o=>{o.preventDefault(),a()};return e.jsxs(re,{"aria-labelledby":"createUserTokenDialogTitle",open:s,fullWidth:!0,maxWidth:"sm",onClose:a,PaperProps:{"data-testid":"create-user-token-dialog"},children:[e.jsx(ne,{id:"createUserTokenDialogTitle",children:"Create User Token"}),e.jsxs("form",{autoComplete:"off",onSubmit:r(n),children:[e.jsx(J,{children:e.jsx(b,{container:!0,spacing:1,children:e.jsx(I,{name:"token_name",control:t,defaultValue:"",rules:{required:"Token name is required"},render:({field:o})=>{var d;return e.jsx(G,{...o,variant:"standard",label:"Token Name",fullWidth:!0,error:!!i.token_name,helperText:(d=i.token_name)==null?void 0:d.message,"data-testid":"create-user-token-dialog_input-token-name"})}})})}),e.jsxs(q,{children:[e.jsx(w,{type:"button",variant:"tertiary",onClick:l,"data-testid":"create-user-token-dialog_button-close",children:"Cancel"}),e.jsx(w,{type:"submit","data-testid":"create-user-token-dialog_button-save",children:"Save"})]})]})]})},xa=({open:s,onCancel:a,onConfirm:n,token:t})=>e.jsxs(re,{open:s,fullWidth:!0,maxWidth:"xs",PaperProps:{"data-testid":"token-revoke-dialog"},children:[e.jsxs(ne,{children:['Revoke "',t==null?void 0:t.name,'" Auth Token']}),e.jsxs(J,{children:[e.jsx(pe,{children:"Are you sure you want to revoke the permanent token? Applications using this token will be unable to contact the API."}),e.jsxs(q,{children:[e.jsx(w,{variant:"tertiary",onClick:a,"data-testid":"token-revoke-dialog_button-close",children:"Cancel"}),e.jsx(w,{onClick:n,"data-testid":"token-revoke-dialog_button-save",children:"Confirm"})]})]})]}),Sa=({open:s,token:a,onClose:n})=>{const t=je();return e.jsxs(re,{open:s,fullWidth:!0,maxWidth:"sm",PaperProps:{"data-testid":"user-token-dialog"},children:[e.jsx(ne,{children:"Auth Token"}),e.jsxs(J,{children:[e.jsx(pe,{children:"Below is the new authentication token. Make sure to save this key, it will not be displayed again."}),e.jsxs(pe,{variant:"body2",sx:{backgroundColor:t.palette.neutral.tertiary,mt:"8px",padding:"8px",borderRadius:"8px"},children:["Key: ",a==null?void 0:a.key,e.jsx("br",{}),"ID: ",a==null?void 0:a.id]})]}),e.jsx(q,{children:e.jsx(w,{variant:"tertiary",onClick:n,"data-testid":"user-token-dialog_button-close",children:"Close"})})]})},vs=({open:s,onClose:a,userId:n})=>{const{isLoading:t,isIdle:r,error:i,data:l,refetch:o}=Y(["getUserTokens",n],({signal:_})=>P.getUserTokens(n,{signal:_}),{enabled:!!s}),{addNotification:d}=de(),[g,y]=v.useState(!1),[u,h]=v.useState(!1),[T,C]=v.useState(void 0),[E,p]=v.useState(!1),x=_=>{C(_),p(!0)},S=async()=>{if(T!=null){try{await P.deleteUserToken(T.id)}catch(_){console.error(_),d(`Error deleting token: ${_}:`,"ErrorDeleteToken")}await o(),c()}},f=async _=>{y(!1);try{const{data:{data:D}}=await P.createUserToken(n,_.token_name);C(D),h(!0)}catch(D){console.error(D),d(`Error creating token: ${D}:`,"ErrorCreateToken")}await o()},c=()=>{C(void 0),h(!1),p(!1)},m=()=>{if(t||r)return e.jsx(le,{children:e.jsx(Q,{colSpan:4,children:e.jsx(ct,{})})});if(i)return e.jsx(le,{children:e.jsx(Q,{children:e.jsx("div",{children:"Error loading user tokens"})})});{const _=(l==null?void 0:l.data.data.tokens)||[];return _.length===0?e.jsx(le,{children:e.jsx(Q,{colSpan:4,align:"center",children:"No tokens available"})}):_.map(D=>e.jsxs(le,{children:[e.jsx(Q,{component:"th",scope:"row",children:D.name}),e.jsx(Q,{children:F.fromISO(D.created_at).toFormat(ae.DATETIME)}),e.jsx(Q,{children:F.fromISO(D.last_access).toFormat(ae.DATETIME)}),e.jsx(Q,{children:e.jsx(w,{variant:"text",size:"small",onClick:()=>x(D),children:"Revoke"})})]},`${D.id}`))}};return e.jsxs(e.Fragment,{children:[e.jsxs(re,{open:s,fullWidth:!0,maxWidth:"md",onClose:a,PaperProps:{"data-testid":"user-token-management-dialog"},children:[e.jsx(ne,{children:"Generate/Revoke API Tokens"}),e.jsxs(J,{children:[e.jsx(pe,{children:"Permanent Authentication Tokens are used for authenticating API calls. Tokens never expire and will remain valid until revoked. Ensure tokens are stored securely."}),e.jsx(M,{variant:"h6",children:"Existing Tokens"}),e.jsxs(ls,{"data-testid":"user-token-management-dialog_table",children:[e.jsx(ds,{children:e.jsxs(le,{children:[e.jsx(Q,{children:"Description"}),e.jsx(Q,{children:"Created"}),e.jsx(Q,{children:"Last Use"}),e.jsx(Q,{children:"Actions"})]})}),e.jsx(cs,{children:m()})]})]}),e.jsxs(q,{children:[e.jsx(w,{variant:"tertiary",onClick:a,"data-testid":"user-token-management-dialog_button-close",children:"Close"}),e.jsx(w,{type:"submit",onClick:()=>y(!0),"data-testid":"user-token-management-dialog_button-save",children:"Create Token"})]})]}),g&&e.jsx(fa,{open:g,onCancel:()=>y(!1),onSubmit:f}),u&&e.jsx(Sa,{open:u,onClose:c,token:T}),E&&e.jsx(xa,{open:E,onCancel:()=>p(!1),onConfirm:S,token:T})]})},Va={data:{node_keys:["admincount","description","displayname","distinguishedname","domain","domainsid","dontreqpreauth","email","enabled","gmsa","hasspn","isaclprotected","lastcollected","lastlogon","lastlogontimestamp","lastseen","msa","name","objectid","ownersid","passwordnotreqd","pwdlastset","pwdneverexpires","samaccountname","sensitive","serviceprincipalnames","sidhistory","system_tags","title","trustedtoauth","unconstraineddelegation","whencreated"],edges:[],nodes:{108:{label:"T1_TONYMONTANA@PHANTOM.CORP",kind:"User",kinds:["User"],objectId:"S-1-5-21-2697957641-2271029196-387917394-2110",isTierZero:!1,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.306Z",properties:{admincount:!0,displayname:"T1_TonyMontana",distinguishedname:"CN=T1_TONYMONTANA,OU=USERS,OU=TIER1,DC=PHANTOM,DC=CORP",domain:"PHANTOM.CORP",domainsid:"S-1-5-21-2697957641-2271029196-387917394",dontreqpreauth:!1,enabled:!0,hasspn:!1,isaclprotected:!0,lastcollected:"2025-07-09T00:28:46.055264963Z",lastlogon:1674216447,lastlogontimestamp:1673626093,lastseen:"2025-07-09T00:28:46.306Z",name:"T1_TONYMONTANA@PHANTOM.CORP",objectid:"S-1-5-21-2697957641-2271029196-387917394-2110",ownersid:"S-1-5-21-2697957641-2271029196-387917394-512",passwordnotreqd:!1,pwdlastset:1664381451,pwdneverexpires:!0,samaccountname:"T1_TonyMontana",sensitive:!1,serviceprincipalnames:[],sidhistory:[],trustedtoauth:!1,unconstraineddelegation:!1,whencreated:1664356251}},489:{label:"ZZZIGNE@PHANTOM.CORP",kind:"User",kinds:["User"],objectId:"S-1-5-21-2697957641-2271029196-387917394-2216",isTierZero:!1,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.292Z",properties:{admincount:!1,displayname:"zzzigne",distinguishedname:"CN=ZZZIGNE,OU=USERS,OU=TIER1,DC=PHANTOM,DC=CORP",domain:"PHANTOM.CORP",domainsid:"S-1-5-21-2697957641-2271029196-387917394",dontreqpreauth:!1,enabled:!0,hasspn:!1,isaclprotected:!1,lastcollected:"2025-07-09T00:28:46.055264963Z",lastlogon:0,lastlogontimestamp:-1,lastseen:"2025-07-09T00:28:46.292Z",name:"ZZZIGNE@PHANTOM.CORP",objectid:"S-1-5-21-2697957641-2271029196-387917394-2216",ownersid:"S-1-5-21-2697957641-2271029196-387917394-512",passwordnotreqd:!1,pwdlastset:1707939756,pwdneverexpires:!0,samaccountname:"zzzigne",sensitive:!1,serviceprincipalnames:[],sidhistory:[],trustedtoauth:!1,unconstraineddelegation:!1,whencreated:1707910956}},490:{label:"SVC_SHS@PHANTOM.CORP",kind:"User",kinds:["User"],objectId:"S-1-5-21-2697957641-2271029196-387917394-2165",isTierZero:!1,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.292Z",properties:{admincount:!1,displayname:"svc_shs",distinguishedname:"CN=SVC_SHS,OU=SHARPHOUND TEST,DC=PHANTOM,DC=CORP",domain:"PHANTOM.CORP",domainsid:"S-1-5-21-2697957641-2271029196-387917394",dontreqpreauth:!1,enabled:!0,hasspn:!1,isaclprotected:!1,lastcollected:"2025-07-09T00:28:46.055264963Z",lastlogon:0,lastlogontimestamp:-1,lastseen:"2025-07-09T00:28:46.292Z",name:"SVC_SHS@PHANTOM.CORP",objectid:"S-1-5-21-2697957641-2271029196-387917394-2165",ownersid:"S-1-5-21-2697957641-2271029196-387917394-512",passwordnotreqd:!1,pwdlastset:1678309565,pwdneverexpires:!0,samaccountname:"svc_shs",sensitive:!1,serviceprincipalnames:[],sidhistory:[],trustedtoauth:!1,unconstraineddelegation:!1,whencreated:1678280765}},491:{label:"NETWORK SERVICE@PHANTOM.CORP",kind:"User",kinds:["User"],objectId:"PHANTOM.CORP-S-1-5-20",isTierZero:!1,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.055264963Z",properties:{domain:"PHANTOM.CORP",domainsid:"S-1-5-21-2697957641-2271029196-387917394",lastcollected:"2025-07-09T00:28:46.055264963Z",lastseen:"2025-07-09T00:28:46.055264963Z",name:"NETWORK SERVICE@PHANTOM.CORP",objectid:"PHANTOM.CORP-S-1-5-20"}},569:{label:"TOM@GHOST.CORP",kind:"User",kinds:["User"],objectId:"S-1-5-21-2845847946-3451170323-4261139666-1105",isTierZero:!0,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.525Z",properties:{admincount:!0,displayname:"tom",distinguishedname:"CN=TOM,CN=USERS,DC=GHOST,DC=CORP",domain:"GHOST.CORP",domainsid:"S-1-5-21-2845847946-3451170323-4261139666",dontreqpreauth:!1,enabled:!1,hasspn:!1,isaclprotected:!0,lastcollected:"2025-07-09T00:28:46.504907963Z",lastlogon:1352620493,lastlogontimestamp:1352620493,lastseen:"2025-07-09T00:28:46.525Z",name:"TOM@GHOST.CORP",objectid:"S-1-5-21-2845847946-3451170323-4261139666-1105",ownersid:"S-1-5-21-2845847946-3451170323-4261139666-512",passwordnotreqd:!1,pwdlastset:1294408493,pwdneverexpires:!0,samaccountname:"tom",sensitive:!1,serviceprincipalnames:[],sidhistory:[],system_tags:"admin_tier_0",trustedtoauth:!1,unconstraineddelegation:!1,whencreated:1107163853}},570:{label:"WALTER@GHOST.CORP",kind:"User",kinds:["User"],objectId:"S-1-5-21-2845847946-3451170323-4261139666-1106",isTierZero:!0,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.525Z",properties:{admincount:!0,displayname:"walter",distinguishedname:"CN=WALTER,CN=USERS,DC=GHOST,DC=CORP",domain:"GHOST.CORP",domainsid:"S-1-5-21-2845847946-3451170323-4261139666",dontreqpreauth:!1,enabled:!1,hasspn:!1,isaclprotected:!0,lastcollected:"2025-07-09T00:28:46.504907963Z",lastlogon:1221657838,lastlogontimestamp:1221657838,lastseen:"2025-07-09T00:28:46.525Z",name:"WALTER@GHOST.CORP",objectid:"S-1-5-21-2845847946-3451170323-4261139666-1106",ownersid:"S-1-5-21-2845847946-3451170323-4261139666-512",passwordnotreqd:!1,pwdlastset:1117877458,pwdneverexpires:!0,samaccountname:"walter",sensitive:!1,serviceprincipalnames:[],sidhistory:[],system_tags:"admin_tier_0",trustedtoauth:!1,unconstraineddelegation:!1,whencreated:1107164693}},571:{label:"ADMINISTRATOR@GHOST.CORP",kind:"User",kinds:["User"],objectId:"S-1-5-21-2845847946-3451170323-4261139666-500",isTierZero:!0,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.525Z",properties:{admincount:!0,description:"Built-in account for administering the computer/domain",distinguishedname:"CN=ADMINISTRATOR,CN=USERS,DC=GHOST,DC=CORP",domain:"GHOST.CORP",domainsid:"S-1-5-21-2845847946-3451170323-4261139666",dontreqpreauth:!1,enabled:!0,hasspn:!1,isaclprotected:!0,lastcollected:"2025-07-09T00:28:46.504907963Z",lastlogon:1702913193,lastlogontimestamp:1702913054,lastseen:"2025-07-09T00:28:46.525Z",name:"ADMINISTRATOR@GHOST.CORP",objectid:"S-1-5-21-2845847946-3451170323-4261139666-500",ownersid:"S-1-5-21-2845847946-3451170323-4261139666-512",passwordnotreqd:!1,pwdlastset:1674763808,pwdneverexpires:!0,samaccountname:"Administrator",sensitive:!1,serviceprincipalnames:[],sidhistory:[],system_tags:"admin_tier_0",trustedtoauth:!1,unconstraineddelegation:!1,whencreated:1656555664}},572:{label:"GUEST@GHOST.CORP",kind:"User",kinds:["User"],objectId:"S-1-5-21-2845847946-3451170323-4261139666-501",isTierZero:!1,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.525Z",properties:{admincount:!1,description:"Built-in account for guest access to the computer/domain",distinguishedname:"CN=GUEST,CN=USERS,DC=GHOST,DC=CORP",domain:"GHOST.CORP",domainsid:"S-1-5-21-2845847946-3451170323-4261139666",dontreqpreauth:!1,enabled:!1,hasspn:!1,isaclprotected:!1,lastcollected:"2025-07-09T00:28:46.504907963Z",lastlogon:0,lastlogontimestamp:-1,lastseen:"2025-07-09T00:28:46.525Z",name:"GUEST@GHOST.CORP",objectid:"S-1-5-21-2845847946-3451170323-4261139666-501",ownersid:"GHOST.CORP-S-1-5-32-544",passwordnotreqd:!0,pwdlastset:0,pwdneverexpires:!0,samaccountname:"Guest",sensitive:!1,serviceprincipalnames:[],sidhistory:[],trustedtoauth:!1,unconstraineddelegation:!1,whencreated:1656555664}},82:{label:"ALICE@PHANTOM.CORP",kind:"User",kinds:["User"],objectId:"S-1-5-21-2697957641-2271029196-387917394-2173",isTierZero:!0,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.292Z",properties:{admincount:!0,displayname:"alice",distinguishedname:"CN=ALICE,OU=USERS,OU=TIER1,DC=PHANTOM,DC=CORP",domain:"PHANTOM.CORP",domainsid:"S-1-5-21-2697957641-2271029196-387917394",dontreqpreauth:!1,enabled:!0,hasspn:!1,isaclprotected:!0,lastcollected:"2025-07-09T00:28:46.055264963Z",lastlogon:0,lastlogontimestamp:-1,lastseen:"2025-07-09T00:28:46.292Z",name:"ALICE@PHANTOM.CORP",objectid:"S-1-5-21-2697957641-2271029196-387917394-2173",ownersid:"S-1-5-21-2697957641-2271029196-387917394-512",passwordnotreqd:!1,pwdlastset:1681286877,pwdneverexpires:!0,samaccountname:"alice",sensitive:!1,serviceprincipalnames:[],sidhistory:[],system_tags:"admin_tier_0",trustedtoauth:!1,unconstraineddelegation:!1,whencreated:1681261677}},9:{label:"CERTMAN@PHANTOM.CORP",kind:"User",kinds:["User"],objectId:"S-1-5-21-2697957641-2271029196-387917394-2201",isTierZero:!0,isOwnedObject:!1,lastSeen:"2025-07-09T00:28:46.292Z",properties:{admincount:!0,displayname:"certman",distinguishedname:"CN=CERTMAN,OU=USERS,OU=TIER0,DC=PHANTOM,DC=CORP",domain:"PHANTOM.CORP",domainsid:"S-1-5-21-2697957641-2271029196-387917394",dontreqpreauth:!1,enabled:!0,hasspn:!1,isaclprotected:!0,lastcollected:"2025-07-09T00:28:46.055264963Z",lastlogon:1695966948,lastlogontimestamp:1695966443,lastseen:"2025-07-09T00:28:46.292Z",name:"CERTMAN@PHANTOM.CORP",objectid:"S-1-5-21-2697957641-2271029196-387917394-2201",ownersid:"S-1-5-21-2697957641-2271029196-387917394-512",passwordnotreqd:!1,pwdlastset:1695966321,pwdneverexpires:!0,samaccountname:"certman",sensitive:!1,serviceprincipalnames:[],sidhistory:[],system_tags:"admin_tier_0",trustedtoauth:!1,unconstraineddelegation:!1,whencreated:1695941121}}}}},Ja=()=>({members:[{asset_group_id:1,object_id:"00000-00001",primary_kind:"User",kinds:["User","Base"],environment_id:"00000-00000-00001",environment_kind:"Domain",name:"USER_00001@TESTLAB.LOCAL",custom_member:!1},{asset_group_id:1,object_id:"00000-00002",primary_kind:"Computer",kinds:["Computer","Base"],environment_id:"00000-00000-00001",environment_kind:"Domain",name:"COMPUTER_00001@TESTLAB.LOCAL",custom_member:!1},{asset_group_id:1,object_id:"00000-00003",primary_kind:"GPO",kinds:["GPO","Base"],environment_id:"00000-00000-00001",environment_kind:"Domain",name:"GPO_00001@TESTLAB.LOCAL",custom_member:!0}]}),Xa=()=>({id:1,name:"Admin Tier Zero",tag:"admin_tier_0",member_count:3,system_group:!0,Selectors:[],created_at:"2023-10-18T16:19:25.26533Z",updated_at:"2023-10-18T16:19:25.26533Z",deleted_at:{Time:"0001-01-01T00:00:00Z",Valid:!1}}),er=()=>[{objectid:"00000-00000-00000-00001",type:"Computer",name:"00001.TESTLAB.LOCAL",distinguishedname:"",system_tags:""}],sr=()=>({environment_id:"000-000-000",primary_kind:"eq:Domain",custom_member:"eq:true"}),tr=()=>({total_count:3,counts:{[ke.User]:1,[ke.Computer]:23,[ke.Domain]:123}}),ar=s=>({user:{roles:[{permissions:s.map(a=>ut[a])}]}}),rr=()=>{const s=window.WebGLRenderingContext,a=document.createElement.bind(document);return{enableWebGLMocks:()=>{window.WebGLRenderingContext=!0,document.createElement=vi.fn(r=>r==="canvas"?{getContext:i=>i==="webgl"}:a(r))},disableWebGLMocks:()=>{window.WebGLRenderingContext=s,document.createElement=a}}},We=()=>Y({queryKey:["getSelf"],queryFn:({signal:s})=>P.getSelf({signal:s}).then(a=>{var n;return(n=a.data)==null?void 0:n.data})}),_s=()=>{const{checkPermission:s}=ge(),a=s(fe.AUTH_MANAGE_USERS);return Y({queryKey:["listUsers"],queryFn:({signal:n})=>P.listUsers({signal:n}).then(t=>{var r,i;return(i=(r=t.data)==null?void 0:r.data)==null?void 0:i.users}),enabled:a})},nr=()=>{const{addNotification:s}=de(),[a,n]=v.useState(!1),[t,r]=v.useState(!1),[i,l]=v.useState(!1),[o,d]=v.useState(!1),[g,y]=v.useState(""),[u,h]=v.useState(""),[T,C]=v.useState(""),[E,p]=v.useState(""),[x,S]=v.useState(""),f=We(),{data:c,isSuccess:m}=mt(),_=m&&(c==null?void 0:c.server_version),D=oe(({userId:N,...R})=>P.putUserAuthSecret(N,R),{onSuccess:()=>{s("Password updated successfully!","updateUserPasswordSuccess"),n(!1)},onError:N=>{var R;((R=N.response)==null?void 0:R.status)==403?s("Current password invalid. Password update failed.","UpdateUserPasswordCurrentPasswordInvalidError"):s("Password failed to update.","UpdateUserPasswordError")}}),A=f.data,B=()=>{var N,R,k,H;return f.isLoading?e.jsx(U,{p:4,textAlign:"center",children:e.jsx(pt,{})}):f.isError?e.jsxs(e.Fragment,{children:[e.jsxs(xe,{severity:"error",children:[e.jsx(gt,{children:"Error"}),"Sorry, there was a problem fetching your user information.",e.jsx("br",{}),"Please try refreshing the page or logging in again."]}),e.jsxs(U,{sx:{flexGrow:1,alignContent:"flex-end"},children:["BloodHound: ",_]})]}):e.jsxs(U,{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"80vh",margin:"0",padding:"0",children:[e.jsxs(U,{children:[e.jsxs(b,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(b,{item:!0,xs:3,children:e.jsx(M,{variant:"body1",children:"Email"})}),e.jsx(b,{item:!0,xs:9,children:e.jsx(M,{variant:"body1",children:A==null?void 0:A.email_address})}),e.jsx(b,{item:!0,xs:3,children:e.jsx(M,{variant:"body1",children:"Name"})}),e.jsx(b,{item:!0,xs:9,children:e.jsx(M,{variant:"body1",children:e.jsx(ns,{text:Gt(A),fallback:"Unknown"})})}),e.jsx(b,{item:!0,xs:3,children:e.jsx(M,{variant:"body1",children:"Role"})}),e.jsx(b,{item:!0,xs:9,children:e.jsx(M,{variant:"body1",children:e.jsx(ns,{text:(R=(N=A==null?void 0:A.roles)==null?void 0:N[0])==null?void 0:R.name,fallback:"Unknown"})})})]}),e.jsx(U,{mt:2,children:e.jsx(M,{variant:"h2",children:"Authentication"})}),e.jsxs(b,{container:!0,spacing:2,alignItems:"center",children:[e.jsxs(b,{container:!0,item:!0,children:[e.jsx(b,{item:!0,xs:3,children:e.jsx(M,{variant:"body1",children:"API Key Management"})}),e.jsx(b,{item:!0,xs:2,children:e.jsx(w,{style:{width:"100%"},onClick:()=>r(!0),"data-testid":"my-profile_button-api-key-management",children:"API Key Management"})})]}),A.sso_provider_id===null&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{container:!0,item:!0,children:[e.jsx(b,{item:!0,xs:3,children:e.jsx(M,{variant:"body1",children:"Password"})}),e.jsx(b,{item:!0,xs:2,children:e.jsx(w,{style:{width:"100%"},onClick:()=>n(!0),"data-testid":"my-profile_button-reset-password",children:"Reset Password"})})]}),e.jsxs(b,{container:!0,item:!0,children:[e.jsx(b,{item:!0,xs:3,children:e.jsx(M,{variant:"body1",children:"Multi-Factor Authentication"})}),e.jsx(b,{item:!0,xs:9,children:e.jsxs(U,{display:"flex",alignItems:"center",children:[e.jsx(Dt,{inputProps:{"aria-label":"Multi-Factor Authentication Enabled"},checked:(k=A.AuthSecret)==null?void 0:k.totp_activated,onChange:()=>{var X;(X=A.AuthSecret)!=null&&X.totp_activated?d(!0):l(!0)},color:"primary","data-testid":"my-profile_switch-multi-factor-authentication"}),((H=A.AuthSecret)==null?void 0:H.totp_activated)&&e.jsx(M,{variant:"body1",children:"Enabled"})]})})]})]})]})]}),e.jsxs(U,{sx:{flexGrow:1,alignContent:"flex-end"},children:["BloodHound: ",_]})]})};return e.jsxs(Ne,{title:"My Profile","data-testid":"my-profile",pageDescription:e.jsx(M,{variant:"body2",paragraph:!0,children:"Review your account and configure user-managed settings."}),children:[e.jsx(M,{variant:"h2",children:"User Information"}),B(),!f.isLoading&&!f.isError&&e.jsxs(e.Fragment,{children:[e.jsx(ps,{open:a,onClose:()=>n(!1),userId:A.id,requireCurrentPassword:!0,showNeedsPasswordReset:!1,onSave:D.mutate}),e.jsx(vs,{open:t,onClose:()=>r(!1),userId:A.id}),e.jsx(ht,{open:i,onClose:()=>{l(!1),C(""),S(""),f.refetch()},onCancel:()=>{l(!1),C(""),S(""),f.refetch()},onSavePassword:N=>(C(""),P.enrollMFA(A.id,{secret:N}).then(R=>{h(R.data.data.qr_code),y(R.data.data.totp_secret),C("")}).catch(R=>{throw C("Unable to verify password. Please try again."),R})),onSaveOTP:N=>(C(""),P.activateMFA(A.id,{otp:N}).then(()=>{C("")}).catch(R=>{throw C("Unable to verify one-time password. Please try again."),R})),onSave:()=>{l(!1),C(""),f.refetch()},TOTPSecret:g,QRCode:u,error:T}),e.jsx(Ss,{open:o,onClose:()=>{d(!1),p(""),f.refetch()},onCancel:()=>{d(!1),p(""),f.refetch()},onSave:N=>{p(""),P.disenrollMFA(A.id,{secret:N}).then(()=>{d(!1),p(""),S(""),f.refetch()}).catch(()=>{p("Unable to verify password. Please try again.")})},error:E,secret:x,onSecretChange:N=>S(N.target.value),contentText:"To stop using multi-factor authentication, please enter your password for security purposes."})]})]})},ya=({error:s,oldSSOProvider:a,roles:n,onClose:t,onSubmit:r})=>{var E,p,x,S;const i=(E=n==null?void 0:n.find(f=>f.name==="Read-Only"))==null?void 0:E.id,l={name:(a==null?void 0:a.name)??"",client_id:((p=a==null?void 0:a.details)==null?void 0:p.client_id)??"",issuer:((x=a==null?void 0:a.details)==null?void 0:x.issuer)??"",config:ys(i,a==null?void 0:a.config)},{control:o,formState:{errors:d},handleSubmit:g,reset:y,resetField:u,setError:h,watch:T}=Oe({defaultValues:l});v.useEffect(()=>{var f,c,m,_;s&&(((f=s==null?void 0:s.response)==null?void 0:f.status)===409?(_=(m=(c=s.response)==null?void 0:c.data)==null?void 0:m.errors[0])!=null&&_.message.toLowerCase().includes("sso provider name")?h("name",{type:"custom",message:"SSO Provider Name is already in use."}):h("root.generic",{type:"custom",message:"A conflict has occured."}):h("root.generic",{type:"custom",message:`Unable to ${a?"update":"create new"} OIDC Provider configuration. Please try again.`}))},[s,h,a]);const C=()=>{t(),y()};return e.jsxs("form",{autoComplete:"off",onSubmit:g(r),children:[e.jsx(J,{children:e.jsxs(b,{container:!0,spacing:2,children:[e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{control:o,name:"name",rules:{required:"OIDC Provider Name is required",pattern:{value:/^[A-z0-9 ]+$/,message:"OIDC Provider Name must be alphanumeric."}},render:({field:f})=>{var c;return e.jsx(G,{...f,id:"name",variant:"standard",fullWidth:!0,name:"name",label:"OIDC Provider Name",error:!!d.name,helperText:((c=d.name)==null?void 0:c.message)||"Choose a name for your OIDC Provider configuration"})}})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{control:o,name:"client_id",rules:{required:"Client ID is required"},render:({field:f})=>{var c;return e.jsx(G,{...f,id:"clientId",variant:"standard",fullWidth:!0,name:"clientId",label:"Client ID",error:!!d.client_id,helperText:((c=d.client_id)==null?void 0:c.message)||"OIDC Provider Client ID"})}})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(I,{control:o,name:"issuer",rules:{required:"Issuer is required"},render:({field:f})=>{var c;return e.jsx(G,{...f,id:"issuer",variant:"standard",fullWidth:!0,name:"issuer",label:"Issuer",error:!!d.issuer,helperText:((c=d.issuer)==null?void 0:c.message)||"OIDC Issuer"})}})}),e.jsx(bs,{control:o,errors:d,readOnlyRoleId:i,resetField:u,roles:n,watch:T}),!!((S=d.root)!=null&&S.generic)&&e.jsx(b,{item:!0,xs:12,children:e.jsx(xe,{severity:"error",children:d.root.generic.message})})]})}),e.jsxs(q,{children:[e.jsx(w,{type:"button",variant:"tertiary",onClick:C,"data-testid":"create-oidc-provider-dialog_button-close",children:"Cancel"}),e.jsx(w,{"data-testid":"create-oidc-provider-dialog_button-save",type:"submit",children:a?"Confirm Edits":"Submit"})]})]})},ba=({open:s,error:a,oldSSOProvider:n,onClose:t,onSubmit:r,roles:i})=>e.jsxs(re,{open:s,onClose:t,fullWidth:!0,maxWidth:"sm",PaperProps:{"data-testid":"create-oidc-provider-dialog"},children:[e.jsxs(ne,{children:[n?"Edit":"Create"," OIDC Provider"]}),e.jsx(ya,{error:a,onClose:t,oldSSOProvider:n,onSubmit:r,roles:i})]}),ir=()=>{const[s,a]=v.useState(),[n,t]=v.useState(),[r,i]=v.useState(""),[l,o]=v.useState(""),[d,g]=v.useState(),[y,u]=v.useState(),{data:h}=os("oidc_support"),T=je(),{checkPermission:C}=ge(),E=C(fe.AUTH_MANAGE_PROVIDERS),{addNotification:p,dismissNotification:x}=de(),S="manage-sso-providers-permission";Be(()=>(E||p("Your user role does not grant permission to manage SSO providers. Please contact your administrator for details.",S,{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}}),()=>x(S)));const c=Y(["getRoles"],({signal:j})=>P.getRoles({signal:j}).then(O=>O.data.data.roles)),m=Y(["listSSOProviders"],({signal:j})=>P.listSSOProviders({signal:j}).then(O=>O.data.data),{enabled:E}),_=oe(j=>P.deleteSSOProvider(j),{onSuccess:()=>{p("SSO Provider successfully deleted!","deleteSSOProviderSuccess",{variant:"success"})},onError:j=>{var O;p(((O=j==null?void 0:j.response)==null?void 0:O.status)===404?"SSO Provider not found.":"Unable to delete sso provider. Please try again.","deleteSSOProviderFailure",{variant:"error"})}}),D=v.useMemo(()=>{let j=m.data??[];return l&&(j=j.filter(O=>{var W,Ae;return(Ae=(W=O.name)==null?void 0:W.toLowerCase())==null?void 0:Ae.includes(l)})),y&&(j=j.sort((O,W)=>{switch(y){case"asc":return O.type.localeCompare(W.type);case"desc":return W.type.localeCompare(O.type)}})),j},[l,y,m.data]),A=v.useMemo(()=>{var j;return(j=m.data)==null?void 0:j.find(({id:O})=>O===s)},[s,m.data]),B=v.useMemo(()=>{var j;return(j=m.data)==null?void 0:j.find(({id:O})=>O===n)},[n,m.data]),N=()=>{i("SAML")},R=()=>{i("OIDC")},k=()=>{i("DELETE")},H=()=>{g(null),i(""),setTimeout(()=>t(void 0),500)},X=j=>{a(j)},Re=j=>O=>{switch(t(O.id),j){case"DELETE":k();break;case"UPDATE":switch(O.type){case"SAML":N();break;case"OIDC":R();break}break}},Te=async()=>{var O;let j=!1;if(n)try{await _.mutateAsync(n)}catch(W){((O=W==null?void 0:W.response)==null?void 0:O.status)!==404&&(j=!0,console.error(W))}j||(H(),_.reset(),m.refetch())},te=()=>{u(!y||y==="desc"?"asc":"desc")},Ee=async j=>{g(null);try{const O={name:j.name,metadata:j.metadata&&j.metadata[0],config:j.config};n?await P.updateSAMLProviderFromFile(n,O):O.name&&O.metadata&&O.config&&await P.createSAMLProviderFromFile({name:O.name,metadata:O.metadata,config:O.config}),m.refetch(),H()}catch(O){console.error(O),g(O)}},Se=async j=>{g(null);try{n?await P.updateOIDCProvider(n,j):j.name&&j.client_id&&j.issuer&&j.config&&await P.createOIDCProvider({name:j.name,client_id:j.client_id,issuer:j.issuer,config:j.config}),m.refetch(),H()}catch(O){console.error(O),g(O)}},ye=j=>{o(j.target.value.toLowerCase())};return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{title:"SSO Configuration","data-testid":"sso-configuration",pageDescription:e.jsxs(M,{variant:"body2",paragraph:!0,children:["BloodHound supports SAML ",h!=null&&h.enabled?"and OIDC ":"","for single sign-on (SSO). Learn how to deploy ",h!=null&&h.enabled?"SSO":"SAML"," with BloodHound"," ",Ze.samlConfigDocLink,"."]}),children:e.jsxs(b,{container:!0,spacing:T.spacing(2),children:[e.jsx(b,{item:!0,display:"flex",alignItems:"center",justifyContent:"end",minHeight:"24px",mb:2,xs:12,children:e.jsx(zt,{disabled:!E,createMenuTitle:`Create ${h!=null&&h.enabled?"":"SAML "}Provider`,featureFlag:"oidc_support",featureFlagEnabledMenuItems:[{title:"SAML Provider",onClick:N},{title:"OIDC Provider",onClick:R}],menuItems:[{title:"Create SAML Provider",onClick:N}]})}),e.jsx(b,{item:!0,xs:6,children:e.jsxs(_e,{children:[e.jsxs(U,{display:"flex",justifyContent:"space-between",children:[e.jsx(U,{display:"flex",alignItems:"center",ml:T.spacing(3),pt:T.spacing(2),children:e.jsx(M,{fontWeight:"bold",variant:"h5",children:"Providers"})}),e.jsx(U,{display:"flex",alignItems:"center",mr:T.spacing(3),children:e.jsx(G,{onChange:ye,variant:"standard",label:e.jsxs(U,{children:["Search",e.jsx(Ie,{icon:ft,size:"sm",style:{marginLeft:T.spacing(1)}})]})})})]}),e.jsx(xt,{ssoProviders:D,loading:m.isLoading,onClickSSOProvider:X,onDeleteSSOProvider:Re("DELETE"),onUpdateSSOProvider:Re("UPDATE"),typeSortOrder:y,onToggleTypeSortOrder:te})]})}),A&&e.jsx(b,{item:!0,xs:6,children:e.jsx(ca,{ssoProvider:A,roles:c.data})})]})}),e.jsx(ga,{open:r==="SAML",oldSSOProvider:B,error:d,onClose:H,onSubmit:Ee,roles:c.data}),e.jsx(ba,{open:r==="OIDC",oldSSOProvider:B,error:d,onClose:H,onSubmit:Se,roles:c.data}),e.jsx(Ce,{open:r==="DELETE",title:"Delete SSO Provider",text:"Are you sure you wish to delete this SSO Provider? Any users which are currently configured to use this provider for authentication will no longer be able to access this application.",onCancel:H,onConfirm:Te,error:_.isError?"An unexpected error has occurred. Please try again.":"",isLoading:_.isLoading})]})},va=[{label:"Username"},{label:"Email"},{label:"Name"},{label:"Created"},{label:"Role"},{label:"Status"},{label:"Auth Method"},{label:"",alignment:"right"}],_a=s=>s.deleted_at.Valid?"Deleted":s.is_disabled?"Disabled":"Active",ja=({onUpdateUser:s,onDisabledUser:a,onEnabledUser:n,onDeleteUser:t,onUpdateUserPassword:r,onExpiredUserPassword:i,onManageUserTokens:l,setDisable2FADialogOpen:o,setSelectedUserId:d})=>{var S,f;const g=je(),y=We(),u=_s(),{checkPermission:h}=ge(),T=h(fe.AUTH_MANAGE_USERS),E=((S=Y(["listSSOProviders"],({signal:c})=>P.listSSOProviders({signal:c}).then(m=>{var _;return(_=m.data)==null?void 0:_.data}),{enabled:T}).data)==null?void 0:S.reduce((c,m)=>(c[m.id]=m,c),{}))||{},p=c=>{var m,_;return c.sso_provider_id?e.jsx("span",{children:`SSO: ${((m=E[c.sso_provider_id])==null?void 0:m.name)||c.sso_provider_id}`}):(_=c.AuthSecret)!=null&&_.totp_activated?e.jsx("span",{style:{whiteSpace:"pre-wrap"},children:`Username / Password
MFA Enabled`}):e.jsx("span",{children:"Username / Password"})},x=(f=u.data)==null?void 0:f.map((c,m)=>{var D,A,B,N,R;const _=!!((D=u.data)!=null&&D.find(({email_address:k,id:H})=>{var X;return((X=c.email_address)==null?void 0:X.toLowerCase())===(k==null?void 0:k.toLowerCase())&&c.id!==H}));return[c.principal_name,e.jsxs(e.Fragment,{children:[c.email_address,_?e.jsx(hs,{title:"Duplicate email detected, unique user emails are required and will be enforced by the database in the following release.",placement:"top-start",children:e.jsx(Ie,{icon:St,style:{marginLeft:g.spacing(1)},color:g.palette.warning.main})}):null]}),`${c.first_name} ${c.last_name}`,e.jsx("span",{style:{whiteSpace:"pre"},children:F.fromISO(c.created_at).toFormat(ae.DATETIME)}),(B=(A=c.roles)==null?void 0:A[0])==null?void 0:B.name,_a(c),p(c),e.jsx(yt,{userId:c.id,onOpen:(k,H)=>{d(H)},showPasswordOptions:!c.sso_provider_id,showAuthMgmtButtons:c.id!==((N=y.data)==null?void 0:N.id),showDisableMfaButton:(R=c.AuthSecret)==null?void 0:R.totp_activated,userDisabled:c.is_disabled,onUpdateUser:s,onDisableUser:a,onEnableUser:n,onDeleteUser:t,onUpdateUserPassword:r,onExpireUserPassword:i,onManageUserTokens:l,onDisableUserMfa:o,index:m})]});return e.jsx(_e,{"data-testid":"manage-users_table",children:e.jsx(qe,{headers:va,data:x,isLoading:u.isLoading,showPaginationControls:!1})})},or=()=>{var $e;const[s,a]=v.useState(null),[n,t]=v.useState(!1),[r,i]=v.useState(""),[l,o]=v.useState(""),[d,g]=v.useState(!1),[y,u]=ie(!1),[h,T]=ie(!1),[C,E]=ie(!1),[p,x]=ie(!1),[S,f]=ie(!1),[c,m]=ie(!1),[_,D]=ie(!1),[A,B]=ie(!1),{checkPermission:N}=ge(),R=N(fe.AUTH_MANAGE_USERS),{addNotification:k,dismissNotification:H}=de(),X="manage-users-permission";Be(()=>(R||k("Your user role does not grant permission for managing users. Please contact your administrator for details.",X,{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}}),()=>H(X)));const Te=We(),te=_s(),Ee=(($e=Te.data)==null?void 0:$e.id)===s,Se=oe(L=>P.createUser(L),{onSuccess:()=>{k("User created successfully!","createUserSuccess"),te.refetch()}}),ye=oe(L=>P.updateUser(s,L),{onSuccess:(L,ee)=>{k("User updated successfully!","updateUserSuccess");const $=_t(te.data,Me=>Me.id===s);($==null?void 0:$.sso_provider_id)!==null&&!ee.SSOProviderId&&(g(!0),D()),te.refetch()}}),j=oe(async({userId:L,disable:ee})=>{var Ke,ze;const $=(Ke=te.data)==null?void 0:Ke.find(Ue=>Ue.id===L);if(!$)return;const Me={emailAddress:$.email_address||"",principal:$.principal_name||"",firstName:$.first_name||"",lastName:$.last_name||"",...$.sso_provider_id&&{SSOProviderId:$.sso_provider_id},roles:((ze=$.roles)==null?void 0:ze.map(Ue=>Ue.id))||[],is_disabled:ee};return P.updateUser(s,Me)},{onSuccess:(L,{disable:ee})=>{k(`User ${ee?"disabled":"enabled"} successfully!`,"disableEnableUserSuccess"),te.refetch()}}),O=oe(L=>P.deleteUser(L),{onSuccess:()=>{k("User deleted successfully!","deleteUserSuccess"),te.refetch()}}),W=oe(L=>P.expireUserAuthSecret(L),{onSuccess:()=>{k("User password expired successfully!","expireUserPasswordSuccess")}}),Ae=oe(({userId:L,...ee})=>P.putUserAuthSecret(L,ee),{onSuccess:()=>{k("User password updated successfully!","updateUserPasswordSuccess"),D()},onSettled:()=>g(!1),onError:L=>{var ee;((ee=L.response)==null?void 0:ee.status)==403?k("Current password invalid. Password update failed.","UpdateUserPasswordCurrentPasswordInvalidError"):k("Password failed to update.","UpdateUserPasswordError")}});return e.jsxs(e.Fragment,{children:[e.jsxs(Ne,{title:"Manage Users","data-testid":"manage-users",pageDescription:e.jsxs(M,{variant:"body2",paragraph:!0,children:["BloodHound offers multiple roles with degrees of permissions, providing greater security and control of your team.",e.jsx("br",{}),"Learn more about ",Ze.ManageUsersDocLink,"."]}),children:[e.jsx(U,{display:"flex",justifyContent:"flex-end",alignItems:"center",minHeight:"24px",mb:2,children:e.jsx(w,{disabled:!R,onClick:()=>{a(null),u()},"data-testid":"manage-users_button-create-user",children:"Create User"})}),e.jsx(_e,{"data-testid":"manage-users_table",children:e.jsx(ja,{onUpdateUser:T,onDisabledUser:E,onEnabledUser:x,onDeleteUser:f,onUpdateUserPassword:D,onExpiredUserPassword:m,onManageUserTokens:B,setDisable2FADialogOpen:t,setSelectedUserId:L=>a(L)})})]}),e.jsx(Vt,{open:y,onClose:u,onExited:Se.reset,onSave:Se.mutateAsync,isLoading:Se.isLoading,error:Se.error}),e.jsx(ha,{open:h,onClose:T,onExited:ye.reset,userId:s,hasSelectedSelf:Ee,onSave:ye.mutateAsync,isLoading:ye.isLoading,error:ye.error}),e.jsx(Ce,{open:p,text:"Are you sure you want to enable this user?",title:"Enable User",onConfirm:()=>{j.mutate({userId:s,disable:!1}),x()},onCancel:x}),e.jsx(Ce,{open:C,text:"Are you sure you want to disable this user?",title:"Disable User",onConfirm:()=>{j.mutate({userId:s,disable:!0}),E()},onCancel:E}),e.jsx(Ce,{open:S,text:"Are you sure you want to delete this user?",title:"Delete User",onConfirm:()=>{O.mutate(s),f()},onCancel:f}),e.jsx(Ce,{open:c,text:"Are you sure you want to expire this user's password? This user will be prompted to change their password on next login.",title:"Force Password Reset",onConfirm:()=>{W.mutate(s),m()},onCancel:m}),e.jsx(Ss,{open:n,onClose:()=>{t(!1),i(""),o(""),Te.refetch()},onCancel:()=>{t(!1),i(""),o(""),Te.refetch()},onSave:L=>{i(""),P.disenrollMFA(s,{secret:L}).then(()=>{t(!1),k("User MFA disabled successfully!","disableUserMfaSuccess"),o(""),te.refetch()}).catch(()=>{i("Unable to verify password. Please try again.")})},error:r,secret:l,onSecretChange:L=>o(L.target.value),contentText:"Are you sure you want to disable MFA for this user? Please enter your password to confirm."}),e.jsx(ps,{open:_,onClose:()=>{D(),g(!1)},userId:s,onSave:Ae.mutate,requireCurrentPassword:Ee,showNeedsPasswordReset:!0,initialNeedsPasswordReset:d}),e.jsx(vs,{open:A,onClose:B,userId:s})]})};export{pr as ADSpecificTimeProperties,gr as AD_NEVER_VALUE,Ru as AD_PLATFORM,fr as AD_UNKNOWN_VALUE,Mu as AZ_PLATFORM,xr as ActiveDirectoryKindProperties,Sr as ActiveDirectoryKindPropertiesToDisplay,ke as ActiveDirectoryNodeKind,yr as ActiveDirectoryNodeKindToDisplay,br as ActiveDirectoryPathfindingEdges,vr as ActiveDirectoryPlatformInfo,_r as ActiveDirectoryRelationshipKind,jr as ActiveDirectoryRelationshipKindToDisplay,Tr as AllEdgeTypes,cr as AnalyzeNowConfiguration,Cr as ApiExplorer,Or as AppIcon,Er as AppLink,Ar as AppNavigate,Pr as AppNotifications,kd as AssetGroupAutocomplete,Fd as AssetGroupChangelogTable,Gd as AssetGroupEdit,Hd as AssetGroupMemberList,Zd as AutocompleteOption,Dr as AzureKindProperties,wr as AzureKindPropertiesToDisplay,Ir as AzureNodeKind,Nr as AzureNodeKindToDisplay,Rr as AzurePathfindingEdges,Mr as AzurePlatformInfo,Ur as AzureRelationshipKind,Lr as AzureRelationshipKindToDisplay,Yd as BaseColumnHeader,kr as BasicObjectInfoFields,Rt as COLLECTION_MAP,ur as CardWithSwitch,Bd as ChangelogAction,Fr as CheckboxGroup,mr as CitrixRDPConfiguration,$d as CollectorCard,Kd as CollectorCardList,Gr as CommonKindProperties,Hr as CommonKindPropertiesToDisplay,Zr as CommonNodeKind,Br as CommonNodeKindToDisplay,oc as CommonSearches,Qr as CommunityIcon,lc as ConfirmUpdateQueryDialog,Ce as ConfirmationDialog,zt as CreateMenu,Vt as CreateUserDialog,Yt as CreateUserForm,Ga as CustomLuxonUtils,wt as CustomRangeError,dc as CypherSearch,cc as CypherSearchMessage,qr as DATE_FIELDS,Wr as DEFAULT_EXPLORE_TABLE_COLUMN_KEYS,$r as DEFAULT_GLYPH_BACKGROUND_COLOR,Kr as DEFAULT_GLYPH_COLOR,zr as DEFAULT_ICON_BACKGROUND_COLOR,Yr as DEFAULT_ICON_COLOR,Vr as DEFAULT_PINNED_COLUMN_KEYS,Jr as DUPLICATED_KNOWN_KEYS,qe as DataTable,nc as DeleteConfirmationDialog,Ss as Disable2FADialog,Ze as DocumentationLinks,Xr as DomainInfo,en as DomainMap,Qd as DropdownSelector,sn as EDGE_ID_PREFIX,tn as EDGE_ID_SEPARATOR,an as EMPTY_FILTER_VALUE,Ua as END_DATE,rn as EdgeCompositionRelationships,uc as EdgeInfoComponents,mc as EdgeInfoPane,nn as EdgeSections,ht as Enable2FADialog,on as EnterpriseIcon,cu as EntityInfoDataTable,hc as EntityInfoDataTableGraphed,uu as EntityInfoPanel,ln as ExploreGraphQueryKey,xu as ExploreSearchCombobox,dn as ExploreTable,Lt as FETCH_ERROR_KEY,Ut as FETCH_ERROR_MESSAGE,cn as FORBIDDEN,gs as FeatureFlag,mu as FetchEntityCacheId,se as Field,lt as FieldsContainer,$a as FileIngest,un as FileStatus,mn as FileUploadDialog,hn as FileUploadDialogContext,pn as FileUploadDialogProvider,gn as FileUploadStep,fn as GLYPHS,xn as GLYPH_SCALE,Sn as GenericErrorBoundaryFallback,yn as GetIconInfo,bn as GloballySupportedSearchParams,vn as GlyphKind,_n as GraphButton,pc as GraphControls,gc as GraphMenu,jn as GraphProgress,fc as GraphViewErrorAlert,qd as GroupManagementContent,Tn as HIGH_VALUE_LABEL,Wt as HYGIENE_AGT_ID,$t as HYGIENE_TAG_NAME,Su as HighlightedText,Cn as INITIAL_FILTERS,On as INITIAL_FILTER_TYPES,En as Icon,xc as ImportQueryDialog,An as InfiniteScrollingTable,Vd as ItemSkeleton,Nt as JOB_STATUS_INDICATORS,It as JOB_STATUS_MAP,Pn as KNOWN_NODE_KEYS,Dn as KnownNodePropertiesToDisplay,wn as LUXON_DATETIME_REGEX,ce as LabelWithCopy,In as LoadContainer,vt as LoadingOverlay,ju as LoginForm,Tu as LoginViaSSOForm,ae as LuxonFormat,De as MAX_EMAIL_LENGTH,z as MAX_NAME_LENGTH,K as MIN_NAME_LENGTH,Nn as MainNav,za as ManagedDatePicker,Rn as MaskedInput,Mn as MenuItem,Un as MetaNodeKind,Ln as NODE_GRAPH_RENDER_LIMIT,kn as NODE_ICONS,Fn as NODE_ID_PREFIX,Gn as NODE_SCALE,ss as NO_PERMISSION_KEY,Mt as NO_PERMISSION_MESSAGE,Sc as NO_RESULTS_TEXT,Ya as NoDataDialog,Hn as NoEntitySelectedHeader,Zn as NoEntitySelectedMessage,Bn as NodeIcon,yc as NodeSearch,Qn as NotificationsProvider,qn as OWNED_OBJECT_TAG,Wn as ObjectInfoFields,$n as ObjectInfoPanelContext,hu as ObjectInfoPanelContextProvider,Cu as OneTimePasscodeForm,Kn as PASSWD_REQS,ut as PERMISSIONS,is as PERSIST_NOTIFICATION,bc as PLACEHOLDER_TEXT,Ne as PageWithTitle,ps as PasswordDialog,Eu as PasswordResetForm,vc as PathfindingSearch,fe as Permission,zn as PrebuiltSearchList,Yn as PrivilegeZones,Vn as PrivilegeZonesContext,_c as QuerySearchFilter,Jn as QuickUploadExclusionIds,Xn as REL_ID_PREFIX,ei as REL_ID_SEPARATOR,si as ROUTE_PRIVILEGE_ZONES,ti as ROUTE_PZ_LABEL_CREATE_SELECTOR,ai as ROUTE_PZ_LABEL_DETAILS,ri as ROUTE_PZ_LABEL_MEMBER_DETAILS,ni as ROUTE_PZ_LABEL_SELECTOR_DETAILS,ii as ROUTE_PZ_LABEL_SELECTOR_MEMBER_DETAILS,oi as ROUTE_PZ_LABEL_SUMMARY,li as ROUTE_PZ_LABEL_UPDATE_SELECTOR,di as ROUTE_PZ_UPDATE_LABEL,ci as ROUTE_PZ_UPDATE_ZONE,ui as ROUTE_PZ_ZONE_CREATE_SELECTOR,mi as ROUTE_PZ_ZONE_DETAILS,hi as ROUTE_PZ_ZONE_MEMBER_DETAILS,pi as ROUTE_PZ_ZONE_SELECTOR_DETAILS,gi as ROUTE_PZ_ZONE_SELECTOR_MEMBER_DETAILS,fi as ROUTE_PZ_ZONE_SUMMARY,xi as ROUTE_PZ_ZONE_UPDATE_SELECTOR,Si as SNACKBAR_DURATION,yi as SNACKBAR_DURATION_LONG,ir as SSOConfiguration,ca as SSOProviderInfoPanel,xt as SSOProviderTable,Ma as START_DATE,jc as SaveQueryActionMenu,Tc as SaveQueryDialog,bi as SavedQueriesContext,Cc as SavedQueriesProvider,Oc as SavedQueryPermissions,Ec as SearchCurrentNodes,yu as SearchResultItem,_i as Section,ji as SetupKeyDialog,wu as SimpleEnvironmentSelector,Jd as SortableHeader,Pu as SourceKindsCheckboxes,Xt as StatusIndicator,Ti as SubHeader,Lu as SubNav,Ci as TAG_OWNED_AGT,Oi as TAG_TIER_ZERO_AGT,Ei as TIER_ZERO_LABEL,Ai as TIER_ZERO_TAG,Ac as TagToZoneLabel,Pc as TagToZoneLabelDialog,Pi as TenantInfo,Di as TenantMap,ns as TextWithFallback,wi as UNKNOWN_ICON,ha as UpdateUserDialog,ua as UpdateUserForm,ga as UpsertSAMLProviderDialog,pa as UpsertSAMLProviderForm,nr as UserProfile,vs as UserTokenManagementDialog,or as Users,Ka as VALIDATIONS,Dc as WebGLDisabledAlert,Je as ZERO_VALUE_API_DATE,Xd as ZoneAnalysisIcon,nm as abbreviatedNumber,Ii as abortEntitySectionRequest,Ni as acceptedExploreSearchTabs,Ri as acceptedSearchTypes,Mi as aclInheritanceSearchQuery,Ui as addOpacityToHex,Li as allSections,P as apiClient,ki as applyPreservedParams,wc as areArraysSimilar,Zu as availableEnvironmentKeys,Fi as baseGraphLayoutOptions,Gi as baseGraphLayouts,Hi as bloodHoundUsersHandlers,qs as cn,Zi as collapseAllSections,im as commaSeparatedNumber,Bi as compareForExploreTableSort,Qi as components,qi as compositionSearchQuery,Vs as copyToClipboard,Wi as createAssetGroupTag,ar as createAuthStateWithPermissions,$i as createColumnStateFromKeys,Ki as createEdgeItemId,zi as createGlyphMapFromTags,Xa as createMockAssetGroup,sr as createMockAssetGroupMemberParams,Ja as createMockAssetGroupMembers,tr as createMockMemberCounts,er as createMockSearchResults,Yi as createNodeItemId,Vi as createPathFilterString,Ji as createRelItemId,Ic as createSavedQuery,Xi as createSelector,eo as createTypedSearchParams,so as cypherSearchGraphQuery,to as cypherSearchQuery,Va as cypherTestResponse,ao as darkPalette,ro as decodeCypherQuery,no as defaultColumns,io as defaultGraphLayout,oo as defaultPortalContainer,lo as defaultPrivilegeZoneCtxValue,co as deleteAssetGroupTag,Nc as deleteQueryPermissions,Rc as deleteSavedQuery,uo as deleteSelector,mo as detailsPath,Mc as downloadFile,ho as edgeInfoSlice,po as edgeSectionToggle,go as edgeinfo,fo as encodeCypherQuery,xo as entityInformationEndpoints,So as entityRelationshipEndpoints,Bu as environmentAggregationMap,yo as exclusionList,bo as exploreGraphQueryFactory,Uc as exportToJson,vo as extractEdgeTypes,_o as fallbackQuery,jo as featureFlagKeys,Us as fileUploadKeys,et as fiveYearsAgo,To as format,Co as formatADSpecificTime,Oo as formatBitwiseInt,Eo as formatBoolean,Ao as formatDateString,Po as formatList,Do as formatNumber,wo as formatObjectInfoFields,Io as formatPotentiallyUnknownLabel,No as formatPrimitive,Ro as getAssetGroupTagMembers,Mo as getAssetGroupTagSelectorMembers,Uo as getAssetGroupTagSelectors,La as getCollectionState,Lo as getCustomNodeKinds,Xu as getEmptyResultsText,ec as getEnvironmentAggregationIds,ko as getExcludedIds,Fo as getExploreTableData,Lc as getExportQuery,Go as getFeatureFlags,Ho as getGlyphFromKinds,kc as getGraphHasData,Zo as getInitialPathFilters,em as getKeywordAndTypeValues,Bo as getModifiedSvgUrlFromIcon,Qo as getNodeByDatabaseIdCypher,bu as getQueryKey,Fc as getQueryPermissions,Gc as getSavedQueries,ms as getSimpleDuration,ku as getSubRoute,Gt as getUsername,qo as glyphUtils,Wo as graphSchema,Hc as importSavedQuery,$o as initialState,ka as isCollectionKey,Ko as isEdge,zo as isEmptyParam,Yo as isGraphResponse,Vo as isNode,Jo as isRequiredColumn,Xo as isSmallColumn,Zc as isWebGLEnabled,sc as itemSkeletons,el as labelsPath,sl as lightPalette,tl as makeFormattedObjectInfoFieldsMap,al as makeStoreMapFromColumnOptions,rl as mapParamsToFilters,nl as membersPath,Za as mockCodemirrorLayoutMethods,il as nodeSearchGraphQuery,ol as nodeSearchQuery,Xs as now,ll as nowDateTime,Qu as parseEnvironmentAggregation,dl as parseItemId,cl as parseRelationshipQueryType,ul as parseSearchTab,ml as parseSearchType,hl as passwordRegex,pl as patchAssetGroupTag,gl as patchSelector,fl as pathfindingSearchGraphQuery,xl as pathfindingSearchQuery,Sl as persistSearchParams,yl as privilegeZonesKeys,bl as privilegeZonesPath,vu as queriesAreLoadingOrErrored,vl as relationshipSearchQuery,_l as savePath,Bc as savedQueryKeys,sm as searchKeys,jl as selectorsPath,Tl as setEdgeInfoOpen,Fs as setParamsFactory,Cl as setRootClass,Ol as setSelectedEdge,El as setSingleParamFactory,Ba as setUpQueryClient,rr as setupWebGLMocks,Al as sharedGraphQueryOptions,Pl as shimGraphSpecificKeys,Dl as summaryPath,wl as testAuthenticatedUser,Il as testBloodHoundUsers,Nl as testMarshallLaw,Rl as testPassword,Ml as testRoles,Ul as testSSOProviders,Fa as toCollected,$s as toFormatted,Ll as toggleFeatureFlag,kl as transformFlatGraphResponse,Ha as typedEntries,Fl as typography,Qc as updateQueryPermissions,qc as updateSavedQuery,Gl as useActiveDirectoryDataQualityHistoryQuery,Hl as useActiveDirectoryDataQualityStatsQuery,Zl as useActiveDirectoryPlatformsDataQualityHistoryQuery,Bl as useActiveDirectoryPlatformsDataQualityStatsQuery,mt as useApiVersion,Ql as useAppNavigate,ql as useAssetGroupTagInfo,Gs as useAssetGroupTags,qu as useAvailableEnvironments,Wl as useAzureDataQualityHistoryQuery,$l as useAzureDataQualityStatsQuery,Kl as useAzurePlatformsDataQualityHistoryQuery,zl as useAzurePlatformsDataQualityStatsQuery,Yl as useCollapsibleSectionStyles,Vl as useCreateAssetGroupTag,Wc as useCreateDisableZoomRef,$c as useCreateSavedQuery,Jl as useCreateSelector,Xl as useCustomNodeKinds,Kc as useCypherSearch,Gu as useDebouncedValue,ed as useDeleteAssetGroupTag,zc as useDeleteQueryPermissions,Yc as useDeleteSavedQuery,sd as useDeleteSelector,td as useEndFileIngestJob,tc as useEnvironmentIdList,Wu as useEnvironmentParams,ad as useExecuteOnFileDrag,rd as useExploreGraph,nd as useExploreParams,id as useExploreSelectedItem,Vc as useExploreTableAutoDisplay,os as useFeatureFlag,od as useFeatureFlags,pu as useFetchEntityProperties,Ks as useFileUploadDialogContext,Qa as useFinishedJobs,zu as useGetConfiguration,ld as useGetFileUploadAcceptedTypesQuery,fs as useGetFileUploadsQuery,Jc as useGetSelectedQuery,Xc as useGraphHasData,dd as useGraphItem,ot as useHeaderStyles,cd as useHighestPrivilegeTag,ks as useHighestPrivilegeTagId,eu as useImportSavedQuery,Iu as useInitialEnvironment,ud as useIsMouseDragging,md as useLabels,xs as useListDisplayRoles,ac as useMatchingPaths,Be as useMountEffect,hd as useNodeByObjectId,su as useNodeSearch,de as useNotifications,pd as useObjectInfoPanelContext,qa as useObjectState,gd as useOnClickOutside,fd as useOrderedTags,xd as useOwnedTagId,Sd as usePZPathParams,it as usePaneStyles,yd as usePatchAssetGroupTag,bd as usePatchSelector,tu as usePathfindingFilters,au as usePathfindingSearch,ge as usePermissions,ru as usePrebuiltQueries,gu as usePreviousValue,Yu as usePrivilegeZoneAnalysis,nu as useQueryPermissions,iu as useSavedQueries,vd as useSavedQueriesContext,tm as useSearch,$u as useSelectedEnvironment,Wa as useSelectedTagName,_d as useSelectorInfo,jd as useSelectorMembersInfiniteQuery,Td as useSelectorsInfiniteQuery,Cd as useShowNavBar,Od as useStartFileIngestJob,Ed as useStyles,Ad as useTagGlyphs,Pd as useTagMembersInfiniteQuery,Dd as useTagsQuery,ie as useToggle,wd as useToggleFeatureFlag,Vu as useUpdateConfiguration,ou as useUpdateQueryPermissions,lu as useUpdateSavedQuery,Id as useUploadFileToIngestJob,qt as useZoneQueryParams,am as validateNodeType,Nd as validateProperty,Rd as zoneHandlers,Md as zoneMocks,Ud as zonesPath};
