import{r as k,bG as A,af as C,g4 as P,g5 as F,cI as D,cK as E,aj as T,aa as e,dU as w,c0 as c,bL as r,du as t,dO as p,bQ as I,bR as N,k2 as _,ab as d,ac as O,k3 as W,cz as R,cA as K,cB as L,dP as S,cC as z}from"./index-DV5vAjQm.js";import{u as B}from"./useMountEffect-CPPlFtO6.js";const G=({flag:a,onClick:i,disabled:n})=>{const o=()=>{i(a.id)};return e.jsx(c,{children:e.jsxs(r,{sx:{p:2,display:"flex",justifyContent:"space-between",gap:"1rem"},children:[e.jsxs(r,{overflow:"hidden",children:[e.jsx(t,{variant:"h6",children:a.name}),e.jsx(t,{variant:"body1",children:a.description})]}),e.jsx(r,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(d,{disabled:n,onClick:o,className:"w-32",children:e.jsxs(r,{display:"flex",alignItems:"center",children:[a.enabled?e.jsx(O,{style:{marginRight:"8px"},icon:W,fixedWidth:!0}):null,e.jsx(t,{children:a.enabled?"Enabled":"Disabled"})]})})})]})})},M=({open:a,onCancel:i,onConfirm:n})=>e.jsxs(R,{open:a,disableEscapeKeyDown:!0,PaperProps:{"data-testid":"early-access-features-warning-dialog"},children:[e.jsx(K,{children:"Heads up!"}),e.jsx(L,{children:e.jsx(S,{children:"The features on this page are under active development and may be unstable, broken, or incomplete."})}),e.jsxs(z,{children:[e.jsx(d,{variant:"tertiary",onClick:i,"data-testid":"early-access-features-warning-dialog_button-close",children:"Take me back"}),e.jsx(d,{variant:"primary",onClick:n,"data-testid":"early-access-features-warning-dialog_button-confirm",children:"I understand, show me the new stuff!"})]})]}),Q=()=>{const[a,i]=k.useState(!0),n=A(),o=C(),{data:u,isLoading:x,isError:f}=P(),j=F(),{checkPermission:m}=D(),h=m(E.APP_WRITE_APPLICATION_CONFIGURATION),{addNotification:y,dismissNotification:b}=T(),g="manage-feature-flags-permission";return B(()=>(h||y("Your role does not grant permission to manage feature flags. Please contact your administrator for details.",g,{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}}),()=>b(g))),e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"Early Access Features","data-testid":"early-access-features",pageDescription:e.jsx(t,{variant:"body2",paragraph:!0,children:"Enable or disable features available under early access. These features may be unstable, broken, or incomplete, but are available for testing."}),children:!a&&(x?e.jsx(c,{elevation:0,children:e.jsxs(r,{p:2,children:[e.jsx(t,{variant:"h6",children:e.jsx(p,{})}),e.jsx(t,{variant:"body1",children:e.jsx(p,{})})]})}):f?e.jsxs(I,{severity:"error",children:[e.jsx(N,{children:"Could Not Display Early Access Features"}),"An unexpected error occurred. Please refresh this page or try again later."]}):u.filter(s=>s.user_updatable).length===0?e.jsx(c,{elevation:0,children:e.jsxs(r,{p:2,children:[e.jsx(t,{variant:"h6",children:"No Early Access Features Available"}),e.jsx(t,{variant:"body1",children:"There are no early access features available at this time. Please check back later."})]})}):u.filter(s=>s.user_updatable).sort((s,l)=>s.id-l.id).map((s,l)=>e.jsx(r,{mt:l===0?0:2,"data-testid":`early-access-features_toggle-${l}`,children:e.jsx(G,{flag:s,onClick:v=>{s.key==="dark_mode"&&n(_(!1)),j.mutate(v)},disabled:a||!h})},s.id)))}),e.jsx(M,{open:a,onCancel:()=>o(-1),onConfirm:()=>i(!1)})]})};export{Q as default};
