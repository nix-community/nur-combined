import{r as s,aI as E,ag as N,ae as P,ai as Q,bE as T,ah as q,bF as v,aa as t,ao as F,aS as l,ap as L,ba as z,ab as x,aq as O,aJ as R}from"./index-DV5vAjQm.js";import{C as V}from"./CypherEditor-B5mKnHUQ.js";const W={dispatch:()=>{},seeds:[],selectedObjects:[],selectorType:E,selectorQuery:{data:void 0,isLoading:!0,isError:!1,isSuccess:!1}},Z=s.createContext(W),w=()=>{},$=({preview:e=!0,initialInput:n=""})=>{var y;const[r,c]=s.useState(n),[g,i]=s.useState(n==null?void 0:n.includes(":Tag_")),[b,d]=s.useState(!1),h=s.useRef(null),u=s.useContext(Z).dispatch||w,{hasZoneId:m}=N(),o=(y=P().state)==null?void 0:y.query;s.useEffect(()=>{!e&&typeof o=="string"&&o.length&&c(o)},[e,o]);const p=Q({queryKey:["graph-kinds"],queryFn:({signal:a})=>R.getKinds({signal:a}).then(_=>_.data.data.kinds)}),f=s.useCallback(()=>T(p.data),[p.data]),C=s.useCallback(()=>{e||r&&(d(!1),u({type:"set-seeds",seeds:[{type:q,value:r}]}))},[r,e,u]),j=s.useCallback(a=>{e||(c(a),d(!0),m&&a.includes(":Tag_")?i(!0):i(!1))},[e,c,m]),S=s.useMemo(()=>`/ui/explore?searchType=cypher&exploreSearchTab=cypher&cypherSearch=${v(r)}`,[r]),k=()=>{var a;return(a=h.current)==null?void 0:a.cypherEditor.focus()};return t.jsxs(F,{className:l({"min-h-[36rem] max-h-[36rem]":!e}),children:[t.jsxs(L,{children:[t.jsxs("div",{className:"flex justify-between items-center px-6 pt-3",children:[t.jsx(z,{children:e?"Cypher Preview":"Cypher Search"}),t.jsxs("div",{className:"flex gap-6",children:[t.jsx(x,{variant:"text",className:"p-0 text-sm",asChild:!0,children:t.jsx("a",{href:S,target:"_blank",rel:"noreferrer",children:"View in Explore"})}),!e&&t.jsx(x,{"data-testid":"privilege-zones_save_selector-form_update-results-button",variant:"text",className:l("p-0 text-sm text-primary font-bold dark:text-secondary-variant-2 hover:no-underline",{"animate-pulse":b}),onClick:C,children:"Update Sample Results"})]})]}),!e&&t.jsx("p",{className:"italic px-6 mt-2 text-sm",children:"Note: The sample results from running this cypher search may include additional entities that are not directly associated with the cypher query due to default selector expansion. In contrast, 'View in Explore' will show only the entities that are directly associated with the cypher query."})]}),t.jsxs(O,{className:"px-6","data-testid":"privilege-zones_cypher-container",children:[t.jsx("div",{onClick:k,className:"flex-1",role:"textbox",children:t.jsx(V,{className:l("flex flex-col border-solid border border-neutral-5 bg-white dark:bg-[#002b36] rounded-lg min-h-64 overflow-auto grow-1",{"bg-transparent [&_.cm-editor]:bg-transparent [&_.cm-editor_.cm-gutters]:bg-transparent [&_.cm-editor_.cm-gutters]:border-transparent dark:bg-transparent dark:[&_.cm-editor]:bg-transparent dark:[&_.cm-editor_.cm-gutters]:bg-transparent dark:[&_.cm-editor_.cm-gutters]:border-transparent":e,"md:min-h-[20rem] md:max-h-[20rem] h-[24rem] max-h-[24rem]":!e}),ref:h,value:e?n:r,onValueChanged:j,theme:document.documentElement.classList.contains("dark")?"dark":"light",schema:f(),readOnly:e,autofocus:!1,placeholder:"Cypher Query",tooltipAbsolute:!1,lineWrapping:!0,lint:!0})}),g&&t.jsx("p",{className:"text-error text-sm p-2",children:"Privilege Zone labels should only be used in cypher within the Explore page. Utilizing Privilege Zone labels in a cypher based Selector seed may result in incomplete data."})]})]})};export{$ as C,Z as S};
