import{w as F,d as G,hS as S,P as T,i as z,K,N as P,G as Q,b as U,g as V,r as p,aa as t,an as W,bQ as Z,bq as Y,br as H,ab as h,aS as j,bs as J,bt as X,dz as v,e4 as R,hU as I,hV as ee,hW as re,hY as ae,hZ as te,ac as g,k0 as C,k1 as w}from"./index-DV5vAjQm.js";import{u as B}from"./useAvailableEnvironments-Dp1ClacZ.js";var ne=G,se=F;function ie(r,e){var a=-1,n=se(r)?Array(r.length):[];return ne(r,function(u,s,i){n[++a]=e(u,s,i)}),n}var ce=ie;function le(r,e){var a=r.length;for(r.sort(e);a--;)r[a]=r[a].value;return r}var ue=le,_=S;function de(r,e){if(r!==e){var a=r!==void 0,n=r===null,u=r===r,s=_(r),i=e!==void 0,o=e===null,d=e===e,c=_(e);if(!o&&!c&&!s&&r>e||s&&i&&d&&!o&&!c||n&&i&&d||!a&&d||!u)return 1;if(!n&&!s&&!c&&r<e||c&&a&&u&&!n&&!s||o&&a&&u||!i&&u||!d)return-1}return 0}var oe=de,pe=oe;function fe(r,e,a){for(var n=-1,u=r.criteria,s=e.criteria,i=u.length,o=a.length;++n<i;){var d=pe(u[n],s[n]);if(d){if(n>=o)return d;var c=a[n];return d*(c=="desc"?-1:1)}}return r.index-e.index}var xe=fe,A=T,he=K,me=U,ye=ce,be=ue,je=Q,ge=xe,Ae=P,Ce=z;function we(r,e,a){e.length?e=A(e,function(s){return Ce(s)?function(i){return he(i,s.length===1?s[0]:s)}:s}):e=[Ae];var n=-1;e=A(e,je(me));var u=ye(r,function(s,i,o){var d=A(e,function(c){return c(s)});return{criteria:d,index:++n,value:s}});return be(u,function(s,i){return ge(s,i,a)})}var _e=we,ke=_e,k=z;function ze(r,e,a,n){return r==null?[]:(k(e)||(e=e==null?[]:[e]),a=n?void 0:a,k(a)||(a=a==null?[]:[a]),ke(r,e,a))}var Be=ze;const Ne=V(Be),qe=r=>{const{orderBy:e="impactValue",handleInitialEnvironment:a,queryOptions:n={}}=r??{},{queryKey:u=[],...s}=n;return B({queryKey:["initial-environment",...u],select:i=>{if(!(i!=null&&i.length))return;const o=i==null?void 0:i.filter(m=>m.collected);if(o.length<1)return;const f=Ne(o,[e],[(e??"impactValue")==="name"?"asc":"desc"])[0];return a&&a(f),f},refetchOnWindowFocus:!1,...s})},Me=(r,e)=>{if(r.type==="active-directory-platform")return"All Active Directory Domains";if(r.type==="azure-platform")return"All Azure Tenants";{const a=e==null?void 0:e.find(n=>n.id===r.id);return a?a.name:"Select Environment"}},Ee=({selected:r,align:e="start",errorMessage:a="",buttonPrimary:n=!1,onSelect:u=()=>{}})=>{const[s,i]=p.useState(!1),[o,d]=p.useState(""),{data:c,isLoading:f,isError:m}=B(),y=()=>i(!1),N=l=>i(l),M=l=>d(l.target.value),O=p.useMemo(()=>!(c!=null&&c.filter(l=>l.type==="active-directory").length),[c]),$=p.useMemo(()=>!(c!=null&&c.filter(l=>l.type==="azure").length),[c]),q=p.useCallback(()=>{u({type:"active-directory-platform",id:null}),y()},[u]),E=p.useCallback(()=>{u({type:"azure-platform",id:null}),y()},[u]),L=p.useCallback(l=>{u({type:l.type,id:l.id}),y()},[u]);if(f)return t.jsx(W,{className:"rounded-md w-10"});if(m)return t.jsx(Z,{severity:"error",children:a});const x=c==null?void 0:c.filter(l=>l.name.toLowerCase().includes(o.toLowerCase())&&l.collected),D=Me(r,c);return t.jsxs(Y,{open:s,onOpenChange:N,children:[t.jsx(H,{asChild:!0,children:t.jsx(h,{variant:"primary",className:j({"bg-transparent rounded-md border uppercase shadow-outer-0 hover:bg-neutral-3 text-black dark:text-white truncate":!n,"w-full":n}),"data-testid":"data-quality_context-selector",children:t.jsxs("span",{className:j("inline-flex justify-between gap-4 items-center",{"w-full":n}),children:[t.jsx("span",{children:D}),t.jsx("span",{className:j({"rotate-180 transition-transform":s,"justify-self-end":n}),children:t.jsx(J.CaretDown,{size:12})})]})})}),t.jsxs(X,{"data-testid":"data-quality_context-selector-popover",align:e,className:"flex flex-col gap-2 p-4 border border-neutral-light-5 w-80",children:[t.jsx("div",{className:"flex px-0 mb-2",children:t.jsx(v,{autoFocus:!0,value:o,onChange:M,variant:"standard",fullWidth:!0,label:"Search","data-testid":"data-quality_context-selector-search"})}),t.jsxs("ul",{children:[x==null?void 0:x.sort((l,b)=>l.name.localeCompare(b.name)).map((l,b)=>t.jsx("li",{className:R(b===x.length-1&&"border-b border-neutral-light-5 pb-2 mb-2"),children:t.jsxs(h,{variant:"text",className:"flex justify-between items-center gap-2 w-full",onClick:()=>{L(l)},children:[t.jsx(I,{children:t.jsxs(ee,{children:[t.jsx(re,{children:t.jsx("span",{className:"uppercase max-w-96 truncate",children:l.name})}),t.jsx(ae,{children:t.jsx(te,{side:"left",className:"dark:bg-neutral-dark-5 border-0",children:t.jsx("span",{className:"uppercase",children:l.name})})})]})}),t.jsx(g,{icon:l.type==="azure"?C:w,size:"sm"})]})},l.id)),t.jsx("li",{children:t.jsxs(h,{className:"flex justify-between items-center gap-2 w-full",onClick:q,disabled:O,variant:"text",children:["All Active Directory Domains",t.jsx(g,{icon:w,size:"sm"})]})},"active-directory-platform"),t.jsx("li",{children:t.jsxs(h,{onClick:E,variant:"text",disabled:$,className:"flex justify-between items-center gap-2 w-full",children:["All Azure Tenants",t.jsx(g,{icon:C,size:"sm"})]})},"azure-platform")]})]})]})};export{Ee as S,qe as u};
