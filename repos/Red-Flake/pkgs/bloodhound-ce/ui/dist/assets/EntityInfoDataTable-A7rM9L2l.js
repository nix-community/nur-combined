import{r as g,c1 as W,c2 as L,c3 as E,iu as Z,c4 as O,jG as Y,c5 as h,aa as n,c7 as A,c6 as P,c9 as k,c0 as $,ca as ee,jX as te,dm as oe,aJ as ne,ai as q,gR as ae,h2 as se,hH as re,e6 as w,gS as ie,R as G,bL as R,hC as ce,hF as le,ac as M,cV as de,cW as pe,bQ as H,bR as ue,bz as z,hI as Q,dO as fe,e2 as V,gX as xe,hB as he,hG as me,e1 as ge,cv as be,cU as F,ig as ve,aP as ye,du as K,ih as je,e0 as Ce,h1 as Ae,h0 as Ie,bZ as Pe,gT as U,ek as Re}from"./index-DV5vAjQm.js";import{v as Se}from"./useSearch-BB_-T_X7.js";const X=g.createContext({});function Ee(e){return L("MuiAccordion",e)}const S=W("MuiAccordion",["root","rounded","expanded","disabled","gutters","region"]),Oe=["children","className","defaultExpanded","disabled","disableGutters","expanded","onChange","square","TransitionComponent","TransitionProps"],ke=e=>{const{classes:t,square:o,expanded:a,disabled:s,disableGutters:r}=e;return k({root:["root",!o&&"rounded",a&&"expanded",s&&"disabled",!r&&"gutters"],region:["region"]},Ee,t)},De=A($,{name:"MuiAccordion",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[{[`& .${S.region}`]:t.region},t.root,!o.square&&t.rounded,!o.disableGutters&&t.gutters]}})(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{position:"relative",transition:e.transitions.create(["margin"],t),overflowAnchor:"none","&:before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(e.vars||e).palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-of-type":{"&:before":{display:"none"}},[`&.${S.expanded}`]:{"&:before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&:before":{display:"none"}}},[`&.${S.disabled}`]:{backgroundColor:(e.vars||e).palette.action.disabledBackground}}},({theme:e,ownerState:t})=>h({},!t.square&&{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(e.vars||e).shape.borderRadius,borderBottomRightRadius:(e.vars||e).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}},!t.disableGutters&&{[`&.${S.expanded}`]:{margin:"16px 0"}})),we=g.forwardRef(function(t,o){const a=E({props:t,name:"MuiAccordion"}),{children:s,className:r,defaultExpanded:c=!1,disabled:l=!1,disableGutters:i=!1,expanded:x,onChange:d,square:f=!1,TransitionComponent:b=Z,TransitionProps:v}=a,j=O(a,Oe),[u,m]=Y({controlled:x,default:c,name:"Accordion",state:"expanded"}),C=g.useCallback(J=>{m(!u),d&&d(J,!u)},[u,d,m]),[p,...y]=g.Children.toArray(s),D=g.useMemo(()=>({expanded:u,disabled:l,disableGutters:i,toggle:C}),[u,l,i,C]),T=h({},a,{square:f,disabled:l,disableGutters:i,expanded:u}),B=ke(T);return n.jsxs(De,h({className:P(B.root,r),ref:o,ownerState:T,square:f},j,{children:[n.jsx(X.Provider,{value:D,children:p}),n.jsx(b,h({in:u,timeout:"auto"},v,{children:n.jsx("div",{"aria-labelledby":p.props.id,id:p.props["aria-controls"],role:"region",className:B.region,children:y})}))]}))});function $e(e){return L("MuiAccordionDetails",e)}W("MuiAccordionDetails",["root"]);const Me=["className"],Ne=e=>{const{classes:t}=e;return k({root:["root"]},$e,t)},We=A("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({padding:e.spacing(1,2,2)})),Le=g.forwardRef(function(t,o){const a=E({props:t,name:"MuiAccordionDetails"}),{className:s}=a,r=O(a,Me),c=a,l=Ne(c);return n.jsx(We,h({className:P(l.root,s),ref:o,ownerState:c},r))});function Te(e){return L("MuiAccordionSummary",e)}const I=W("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),Be=["children","className","expandIcon","focusVisibleClassName","onClick"],Ge=e=>{const{classes:t,expanded:o,disabled:a,disableGutters:s}=e;return k({root:["root",o&&"expanded",a&&"disabled",!s&&"gutters"],focusVisible:["focusVisible"],content:["content",o&&"expanded",!s&&"contentGutters"],expandIconWrapper:["expandIconWrapper",o&&"expanded"]},Te,t)},Ve=A(ee,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{const o={duration:e.transitions.duration.shortest};return h({display:"flex",minHeight:48,padding:e.spacing(0,2),transition:e.transitions.create(["min-height","background-color"],o),[`&.${I.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${I.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`&:hover:not(.${I.disabled})`]:{cursor:"pointer"}},!t.disableGutters&&{[`&.${I.expanded}`]:{minHeight:64}})}),Fe=A("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(e,t)=>t.content})(({theme:e,ownerState:t})=>h({display:"flex",flexGrow:1,margin:"12px 0"},!t.disableGutters&&{transition:e.transitions.create(["margin"],{duration:e.transitions.duration.shortest}),[`&.${I.expanded}`]:{margin:"20px 0"}})),Ue=A("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(e,t)=>t.expandIconWrapper})(({theme:e})=>({display:"flex",color:(e.vars||e).palette.action.active,transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),[`&.${I.expanded}`]:{transform:"rotate(180deg)"}})),_e=g.forwardRef(function(t,o){const a=E({props:t,name:"MuiAccordionSummary"}),{children:s,className:r,expandIcon:c,focusVisibleClassName:l,onClick:i}=a,x=O(a,Be),{disabled:d=!1,disableGutters:f,expanded:b,toggle:v}=g.useContext(X),j=C=>{v&&v(C),i&&i(C)},u=h({},a,{expanded:b,disabled:d,disableGutters:f}),m=Ge(u);return n.jsxs(Ve,h({focusRipple:!1,disableRipple:!0,disabled:d,component:"div","aria-expanded":b,className:P(m.root,r),focusVisibleClassName:P(m.focusVisible,l),onClick:j,ref:o,ownerState:u},x,{children:[n.jsx(Fe,{className:m.content,ownerState:u,children:s}),c&&n.jsx(Ue,{className:m.expandIconWrapper,ownerState:u,children:c})]}))}),qe=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],He=e=>{const{absolute:t,children:o,classes:a,flexItem:s,light:r,orientation:c,textAlign:l,variant:i}=e;return k({root:["root",t&&"absolute",i,r&&"light",c==="vertical"&&"vertical",s&&"flexItem",o&&"withChildren",o&&c==="vertical"&&"withChildrenVertical",l==="right"&&c!=="vertical"&&"textAlignRight",l==="left"&&c!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",c==="vertical"&&"wrapperVertical"]},te,a)},ze=A("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,o.absolute&&t.absolute,t[o.variant],o.light&&t.light,o.orientation==="vertical"&&t.vertical,o.flexItem&&t.flexItem,o.children&&t.withChildren,o.children&&o.orientation==="vertical"&&t.withChildrenVertical,o.textAlign==="right"&&o.orientation!=="vertical"&&t.textAlignRight,o.textAlign==="left"&&o.orientation!=="vertical"&&t.textAlignLeft]}})(({theme:e,ownerState:t})=>h({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin"},t.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},t.light&&{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:oe(e.palette.divider,.08)},t.variant==="inset"&&{marginLeft:72},t.variant==="middle"&&t.orientation==="horizontal"&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},t.variant==="middle"&&t.orientation==="vertical"&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},t.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},t.flexItem&&{alignSelf:"stretch",height:"auto"}),({ownerState:e})=>h({},e.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{content:'""',alignSelf:"center"}}),({theme:e,ownerState:t})=>h({},t.children&&t.orientation!=="vertical"&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`}}),({theme:e,ownerState:t})=>h({},t.children&&t.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`}}),({ownerState:e})=>h({},e.textAlign==="right"&&e.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},e.textAlign==="left"&&e.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),Qe=A("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.wrapper,o.orientation==="vertical"&&t.wrapperVertical]}})(({theme:e,ownerState:t})=>h({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`},t.orientation==="vertical"&&{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`})),_=g.forwardRef(function(t,o){const a=E({props:t,name:"MuiDivider"}),{absolute:s=!1,children:r,className:c,component:l=r?"div":"hr",flexItem:i=!1,light:x=!1,orientation:d="horizontal",role:f=l!=="hr"?"separator":void 0,textAlign:b="center",variant:v="fullWidth"}=a,j=O(a,qe),u=h({},a,{absolute:s,component:l,flexItem:i,light:x,orientation:d,role:f,textAlign:b,variant:v}),m=He(u);return n.jsx(ze,h({as:l,className:P(m.root,c),role:f,ref:o,ownerState:u},j,{children:r?n.jsx(Qe,{className:m.wrapper,ownerState:u,children:r}):null}))}),Ke="entity-properties",Xe=({objectId:e,nodeType:t,databaseId:o})=>{const a={endpoint:async function(){return{}},param:""},s=Se(t);s?(a.endpoint=ae[s],a.param=e):o&&(a.endpoint=ne.cypherSearch,a.param=se(o));const r=!!s||!!o,{data:c,isLoading:l,isError:i,isSuccess:x}=q([Ke,t,e],({signal:d})=>a.endpoint(a.param,{signal:d},!0).then(f=>s?f.data.data.props:o?Object.values(f.data.data.nodes)[0].properties:{}),{refetchOnWindowFocus:!1,retry:!1,enabled:r});return{entityProperties:c,informationAvailable:r,isLoading:l,isError:i,isSuccess:x}},Je=e=>{const t=g.useRef();return g.useEffect(()=>{t.current=e}),t.current};function Ze({children:e}){const[t,o]=g.useState(!0),a=g.useMemo(()=>({isObjectInfoPanelOpen:t,setIsObjectInfoPanelOpen:o}),[t]);return n.jsx(re.Provider,{value:a,children:e})}const Ye=({id:e,nodeType:t,additionalTables:o,DataTable:a})=>{var c,l;let s=t;(t===w.LocalGroup||t===w.LocalUser)&&(s=w.Entity);const r=((l=(c=ie)[s])==null?void 0:l.call(c,e))||[];return n.jsxs("div",{"data-testid":"entity-info-data-table-list",children:[r.map((i,x)=>n.jsxs(G.Fragment,{children:[n.jsx(R,{padding:1,children:n.jsx(_,{})}),n.jsx(a,{...i})]},x)),o==null?void 0:o.map((i,x)=>{const{sectionProps:d,TableComponent:f}=i;return n.jsxs(G.Fragment,{children:[n.jsx(R,{padding:1,children:n.jsx(_,{})}),n.jsx(f,{...d})]},x)})]})},et=({error:e})=>{var o;let t="An unknown error occurred during the request.";switch((o=e==null?void 0:e.response)==null?void 0:o.status){case 500:t="The request could not be completed, possibly due to the volume of objects involved.";break;case 504:t="The results took too long to complete, possibly due to the volume of objects involved.";break}return n.jsx(H,{severity:"error",icon:!1,children:n.jsx(ue,{sx:{fontSize:"0.75rem"},children:t})})},N=({children:e,label:t="",count:o,onChange:a=()=>{},isLoading:s=!1,isError:r=!1,error:c=null,isExpanded:l})=>{const i=ce(),x=s||o===0&&!r;return n.jsxs(we,{expanded:l,onChange:(d,f)=>{a(f)},disabled:x,TransitionProps:{unmountOnExit:!0},className:i.accordionRoot,children:[n.jsx(_e,{expandIcon:n.jsx(M,{icon:l?de:pe}),className:"accordion-summary",classes:{root:i.accordionSummary,expandIconWrapper:i.expandIcon},children:n.jsx(le,{label:t,isLoading:s,isError:r,count:o})}),n.jsx(Le,{className:i.accordionDetails,children:r?n.jsx(et,{error:c}):e})]})},tt=({id:e,nodeType:t,databaseId:o})=>{const{setExploreParams:a}=z(),{isObjectInfoPanelOpen:s,setIsObjectInfoPanelOpen:r}=Q(),{entityProperties:c,informationAvailable:l,isLoading:i,isError:x}=Xe({objectId:e,nodeType:t,databaseId:o}),d=Je(e);g.useEffect(()=>{d!==e&&r(!0)},[d,e,r]);const f="Object Information",b=()=>{r(!s)};if(i)return n.jsx(fe,{"data-testid":"entity-object-information-skeleton",variant:"text"});if(x||!l)return n.jsx(N,{onChange:b,isExpanded:s,label:f,children:n.jsx(V,{children:n.jsx(H,{severity:"error",children:"Unable to load object information for this node."})})});const v=xe(c),j=u=>{a({primarySearch:u.objectid,searchType:"node"})};return n.jsx(N,{onChange:b,isExpanded:s,label:f,children:n.jsxs(V,{children:[n.jsx(he,{nodeType:t,handleSourceNodeSelected:j,...c}),n.jsx(me,{fields:v})]})})},ot=e=>n.jsxs(R,{children:[n.jsx(tt,{...e}),n.jsx(Ye,{...e})]}),nt=({name:e,nodeType:t})=>{const o=ge(),{setIsObjectInfoPanelOpen:a}=Q(),{setExploreParams:s,expandedPanelSections:r}=z(),{clearSelectedItem:c,selectedItem:l}=be(),i=()=>{a(!1),r!=null&&r.length&&s({expandedPanelSections:[]})};return n.jsxs(R,{className:o.header,children:[l?n.jsx(F,{className:o.icon,click:c,tip:"Clear selected item",children:n.jsx(M,{icon:ve})}):n.jsx("div",{className:"w-3"}),t&&n.jsx(ye,{nodeType:t}),n.jsx(K,{"data-testid":"explore_entity-information-panel_header-text",variant:"h6",noWrap:!0,className:o.headerText,children:e}),n.jsx(F,{tip:"Collapse All",click:i,className:o.icon,"data-testid":"explore_entity-information-panel_button-collapse-all",children:n.jsx(M,{icon:je})})]})},at=({selectedNode:e,sx:t,additionalTables:o,DataTable:a})=>{const s=Ce();return n.jsxs(R,{sx:t,className:s.container,"data-testid":"explore_entity-information-panel",children:[n.jsx($,{elevation:0,classes:{root:s.headerPaperRoot},children:n.jsx(nt,{name:(e==null?void 0:e.name)||Ae,nodeType:e==null?void 0:e.type})}),n.jsx($,{elevation:0,classes:{root:s.contentPaperRoot},children:e?n.jsx(ot,{DataTable:a,id:e.id,nodeType:e.type,databaseId:e.graphId,additionalTables:o}):n.jsx(K,{variant:"body2",children:Ie})})]})},ct=e=>n.jsx(Ze,{children:n.jsx(at,{...e})}),st=({id:e,label:t,queryType:o,countLabel:a,sections:s,parentLabels:r=[]})=>{var C;const[c,l]=Pe(),i=o?U[o]:void 0,x=c.getAll("expandedPanelSections").includes(t),d=q(["relatedCount",t,e],()=>i?i({id:e,skip:0,limit:128}):s?Promise.all(s.map(p=>{const y=p.queryType?U[p.queryType]:void 0;return y?y({id:e,skip:0,limit:128}):Promise.resolve()})):Promise.reject("Invalid call data provided for relationship list query"),{refetchOnWindowFocus:!1,retry:!1}),f=()=>{l({expandedPanelSections:r})},b=()=>{const p=[...r,t];l({expandedPanelSections:p})},v=()=>{const p=[...r,t];l({expandedPanelSections:p})},j=p=>{p?u():f()},u=async()=>{i?v():b()};let m;return Array.isArray(d.data)?a!==void 0?d.data.forEach(p=>{p.countLabel===a&&(m=p.count)}):m=d.data.reduce((p,y)=>{const D=(y==null?void 0:y.count)??0;return p+D},0):d.data&&(m=((C=d.data)==null?void 0:C.count)??0),n.jsxs(N,{count:m,error:d.error,isError:d.isError,isExpanded:x,isLoading:d.isLoading,label:t,onChange:j,children:[i&&n.jsx(Re,{itemCount:m,fetchDataCallback:p=>i({id:e,...p})}),s&&s.map((p,y)=>g.createElement(st,{...p,"data-testid":"entity-info-data-table",key:y,parentLabels:[...r,t]}))]})};export{we as A,_ as D,N as E,Ke as F,Ze as O,ct as W,st as a,Je as b,_e as c,Le as d,Xe as u};
