import{r as o,aa as t,dU as l,bL as n,bQ as x,bR as y,i6 as S,dw as h,du as I,hR as w,hQ as Q,hO as T,hN as k}from"./index-DV5vAjQm.js";import{u as A,S as f}from"./SimpleEnvironmentSelector-B_K17Cs3.js";import{L as C}from"./LoadingOverlay-B6fAvbKP.js";import{d as g}from"./utils-D-6qVNBA.js";import"./useAvailableEnvironments-Dp1ClacZ.js";const L=(e,r)=>{const i=e==null?void 0:e.type,s=e==null?void 0:e.id;switch(i){case"active-directory":return s?t.jsx(k,{contextId:s,onDataError:r}):null;case"active-directory-platform":return t.jsx(T,{onDataError:r});case"azure":return s?t.jsx(Q,{contextId:s,onDataError:r}):null;case"azure-platform":return t.jsx(w,{onDataError:r});default:return null}},F=()=>{const{data:e,isLoading:r}=A({orderBy:"name"}),[i,s]=o.useState(e??null),a=i??e,j=!(a!=null&&a.id)&&((a==null?void 0:a.type)==="active-directory"||(a==null?void 0:a.type)==="azure"),d=b=>s(b),[m,u]=o.useState(!1);o.useEffect(()=>{e&&s(e)},[e]),o.useEffect(()=>{u(!1)},[a]);const D=()=>{u(!0)},p=t.jsxs(t.Fragment,{children:["Environments unavailable. ",g]});return r?t.jsx(l,{title:"Data Quality","data-testid":"data-quality",pageDescription:t.jsxs(t.Fragment,{children:[t.jsx(c,{}),t.jsx(C,{loading:!0})]})}):!(a!=null&&a.type)||j?t.jsxs(l,{title:"Data Quality","data-testid":"data-quality",pageDescription:t.jsx(c,{}),children:[t.jsx(n,{display:"flex",justifyContent:"flex-end",alignItems:"center",minHeight:"24px",mb:2,children:t.jsx(f,{align:"end",selected:{type:(a==null?void 0:a.type)??null,id:(a==null?void 0:a.id)??null},errorMessage:p,onSelect:d})}),t.jsxs(x,{severity:"info",children:[t.jsx(y,{children:"No Domain or Tenant Selected"}),"Select a domain or tenant to view data. If you are unable to select a domain, you may need to run data collection first. ",g]})]}):t.jsxs(l,{title:"Data Quality","data-testid":"data-quality",pageDescription:t.jsx(c,{}),children:[t.jsx(n,{display:"flex",justifyContent:"flex-end",alignItems:"center",minHeight:"24px",mb:2,children:t.jsx(f,{align:"end",selected:{type:(i==null?void 0:i.type)??null,id:(i==null?void 0:i.id)??null},errorMessage:p,onSelect:d})}),m&&t.jsx(n,{paddingBottom:2,children:t.jsxs(x,{severity:"warning",children:[t.jsx(y,{children:"Data Quality Warning"}),"It looks like data is incomplete or has not been collected yet. See the"," ",t.jsx(S,{target:"_blank",href:"https://bloodhound.specterops.io/collect-data/overview#bloodhound-ce-collection",children:"Data Collection"})," ","page to view instructions on how to begin data collection."]})}),t.jsx(h,{container:!0,spacing:2,children:t.jsx(h,{item:!0,xs:12,"data-testid":"data-quality_statistics",children:L(a,D)})})]})},c=()=>t.jsx(I,{variant:"body2",paragraph:!0,children:"Understand the data collected within BloodHound broken down by environment and principal type."});export{F as default};
